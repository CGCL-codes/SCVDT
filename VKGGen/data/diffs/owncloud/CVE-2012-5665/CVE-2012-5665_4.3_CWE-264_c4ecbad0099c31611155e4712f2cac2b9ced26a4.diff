From c4ecbad0099c31611155e4712f2cac2b9ced26a4 Mon Sep 17 00:00:00 2001
From: Frank Karlitschek <frank@owncloud.org>
Date: Mon, 17 Dec 2012 14:46:57 +0100
Subject: [PATCH] check if admin

---
 apps/files_encryption/settings.php | 4 +++-
 apps/files_external/settings.php   | 2 ++
 apps/user_ldap/settings.php        | 3 +++
 apps/user_webdavauth/settings.php  | 2 ++
 4 files changed, 10 insertions(+), 1 deletion(-)

diff --git a/apps/files_encryption/settings.php b/apps/files_encryption/settings.php
index 6b2b03211e2..94ff5ab94ba 100644
--- a/apps/files_encryption/settings.php
+++ b/apps/files_encryption/settings.php
@@ -6,6 +6,8 @@
  * See the COPYING-README file.
  */
 
+OC_Util::checkAdminUser();
+
 $tmpl = new OCP\Template( 'files_encryption', 'settings');
 $blackList=explode(',', OCP\Config::getAppValue('files_encryption',
 												'type_blacklist',
@@ -17,4 +19,4 @@
 OCP\Util::addscript('files_encryption', 'settings');
 OCP\Util::addscript('core', 'multiselect');
 
-return $tmpl->fetchPage();
\ No newline at end of file
+return $tmpl->fetchPage();
diff --git a/apps/files_external/settings.php b/apps/files_external/settings.php
index 2f239f7cb95..cd0bfa99585 100644
--- a/apps/files_external/settings.php
+++ b/apps/files_external/settings.php
@@ -20,6 +20,8 @@
 * License along with this library.  If not, see <http://www.gnu.org/licenses/>.
 */
 
+OC_Util::checkAdminUser();
+
 OCP\Util::addScript('files_external', 'settings');
 OCP\Util::addscript('3rdparty', 'chosen/chosen.jquery.min');
 OCP\Util::addStyle('files_external', 'settings');
diff --git a/apps/user_ldap/settings.php b/apps/user_ldap/settings.php
index 2ee936d29a8..58ec8e7f7a4 100644
--- a/apps/user_ldap/settings.php
+++ b/apps/user_ldap/settings.php
@@ -20,6 +20,9 @@
  * License along with this library.  If not, see <http://www.gnu.org/licenses/>.
  *
  */
+
+OC_Util::checkAdminUser();
+
 $params = array('ldap_host', 'ldap_port', 'ldap_dn', 'ldap_agent_password', 'ldap_base', 'ldap_base_users', 'ldap_base_groups', 'ldap_userlist_filter', 'ldap_login_filter', 'ldap_group_filter', 'ldap_display_name', 'ldap_group_display_name', 'ldap_tls', 'ldap_turn_off_cert_check', 'ldap_nocase', 'ldap_quota_def', 'ldap_quota_attr', 'ldap_email_attr', 'ldap_group_member_assoc_attribute', 'ldap_cache_ttl', 'home_folder_naming_rule');
 
 OCP\Util::addscript('user_ldap', 'settings');
diff --git a/apps/user_webdavauth/settings.php b/apps/user_webdavauth/settings.php
index 910073c7841..41d7fa51cd2 100755
--- a/apps/user_webdavauth/settings.php
+++ b/apps/user_webdavauth/settings.php
@@ -21,6 +21,8 @@
  *
  */
 
+OC_Util::checkAdminUser();
+
 if($_POST) {
 
 	if(isset($_POST['webdav_url'])) {
