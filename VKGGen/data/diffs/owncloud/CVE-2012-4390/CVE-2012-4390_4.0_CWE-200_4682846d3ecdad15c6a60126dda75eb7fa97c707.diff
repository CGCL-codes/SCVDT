From 4682846d3ecdad15c6a60126dda75eb7fa97c707 Mon Sep 17 00:00:00 2001
From: Lukas Reschke <lukas@statuscode.ch>
Date: Tue, 14 Aug 2012 17:19:20 +0200
Subject: [PATCH] Disable user enumeration

---
 apps/calendar/appinfo/remote.php | 11 +++++++----
 apps/contacts/appinfo/remote.php | 11 +++++++----
 2 files changed, 14 insertions(+), 8 deletions(-)

diff --git a/apps/calendar/appinfo/remote.php b/apps/calendar/appinfo/remote.php
index 93d57b2e40c..d500ec1080a 100644
--- a/apps/calendar/appinfo/remote.php
+++ b/apps/calendar/appinfo/remote.php
@@ -21,12 +21,15 @@
 $caldavBackend    = new OC_Connector_Sabre_CalDAV();
 
 // Root nodes
-$collection = new Sabre_CalDAV_Principal_Collection($principalBackend); 
-$collection->disableListing = true; // Disable listening
+$Sabre_CalDAV_Principal_Collection = new Sabre_CalDAV_Principal_Collection($principalBackend); 
+$Sabre_CalDAV_Principal_Collection->disableListing = true; // Disable listening
+
+$Sabre_CalDAV_CalendarRootNode = new Sabre_CalDAV_CalendarRootNode($principalBackend, $caldavBackend); 
+$Sabre_CalDAV_CalendarRootNode->disableListing = true; // Disable listening
 
 $nodes = array( 
-	$collection, 
-	new Sabre_CalDAV_CalendarRootNode($principalBackend, $caldavBackend),
+	$Sabre_CalDAV_Principal_Collection, 
+	$Sabre_CalDAV_CalendarRootNode,
 	);
 
 
diff --git a/apps/contacts/appinfo/remote.php b/apps/contacts/appinfo/remote.php
index 2a6a3bea2e1..2810358e7f2 100644
--- a/apps/contacts/appinfo/remote.php
+++ b/apps/contacts/appinfo/remote.php
@@ -36,12 +36,15 @@
 $carddavBackend   = new OC_Connector_Sabre_CardDAV();
 
 // Root nodes
-$collection = new Sabre_CalDAV_Principal_Collection($principalBackend); 
-$collection->disableListing = true; // Disable listening
+$Sabre_CalDAV_Principal_Collection = new Sabre_CalDAV_Principal_Collection($principalBackend); 
+$Sabre_CalDAV_Principal_Collection->disableListing = true; // Disable listening
+
+$Sabre_CardDAV_AddressBookRoot = new Sabre_CardDAV_AddressBookRoot($principalBackend, $carddavBackend);
+$Sabre_CardDAV_AddressBookRoot->disableListing = true; // Disable listening
 
 $nodes = array( 
-	$collection, 
-	new Sabre_CardDAV_AddressBookRoot($principalBackend, $carddavBackend),
+	$Sabre_CalDAV_Principal_Collection, 
+	$Sabre_CardDAV_AddressBookRoot,
 	);
 
 // Fire up server
