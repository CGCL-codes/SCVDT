diff --git a/cayenne-server/src/main/java/org/apache/cayenne/util/Util.java b/cayenne-server/src/main/java/org/apache/cayenne/util/Util.java
index 7aa0f9bc69..429a833c66 100644
--- a/cayenne-server/src/main/java/org/apache/cayenne/util/Util.java
+++ b/cayenne-server/src/main/java/org/apache/cayenne/util/Util.java
@@ -346,17 +346,16 @@ public static String uncapitalized(String aString) {
 	 */
 	public static XMLReader createXmlReader() throws SAXException, ParserConfigurationException {
 		SAXParserFactory spf = SAXParserFactory.newInstance();
+		spf.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true);
+		spf.setFeature("http://xml.org/sax/features/external-general-entities", false);
+		spf.setFeature("http://xml.org/sax/features/external-parameter-entities", false);
+		spf.setFeature("http://xml.org/sax/features/namespaces", true);
 
 		// Create a JAXP SAXParser
 		SAXParser saxParser = spf.newSAXParser();
 
 		// Get the encapsulated SAX XMLReader
-		XMLReader reader = saxParser.getXMLReader();
-
-		// set default features
-		reader.setFeature("http://xml.org/sax/features/namespaces", true);
-
-		return reader;
+		return saxParser.getXMLReader();
 	}
 
 	/**
