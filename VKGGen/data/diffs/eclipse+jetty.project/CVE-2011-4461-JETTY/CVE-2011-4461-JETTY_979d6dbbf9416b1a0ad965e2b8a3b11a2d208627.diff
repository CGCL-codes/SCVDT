diff --git a/jetty-util/src/main/java/org/eclipse/jetty/util/UrlEncoded.java b/jetty-util/src/main/java/org/eclipse/jetty/util/UrlEncoded.java
index 05bd29686a7..b1a47f6c3a3 100644
--- a/jetty-util/src/main/java/org/eclipse/jetty/util/UrlEncoded.java
+++ b/jetty-util/src/main/java/org/eclipse/jetty/util/UrlEncoded.java
@@ -224,10 +224,7 @@ else if (value!=null&&value.length()>0)
                       key = null;
                       value=null;
                       if (maxKeys>0 && map.size()>maxKeys)
-                      {
-                          LOG.warn("maxFormKeys limit exceeded keys>{}",maxKeys);
-                          return;
-                      }
+                          throw new IllegalStateException("Form too many keys");
                       break;
                   case '=':
                       if (key!=null)
@@ -396,10 +393,7 @@ else if (value!=null&&value.length()>0)
                         key = null;
                         value=null;
                         if (maxKeys>0 && map.size()>maxKeys)
-                        {
-                            LOG.warn("maxFormKeys limit exceeded keys>{}",maxKeys);
-                            return;
-                        }
+                            throw new IllegalStateException("Form too many keys");
                         break;
                         
                     case '=':
@@ -483,10 +477,7 @@ else if (value!=null&&value.length()>0)
                             key = null;
                             value=null;
                             if (maxKeys>0 && map.size()>maxKeys)
-                            {
-                                LOG.warn("maxFormKeys limit exceeded keys>{}",maxKeys);
-                                return;
-                            }
+                                throw new IllegalStateException("Form too many keys");
                             break;
 
                         case '=':
@@ -611,6 +602,8 @@ else if (value!=null&&value.length()>0)
                         }
                         key = null;
                         value=null;
+                        if (maxKeys>0 && map.size()>maxKeys)
+                            throw new IllegalStateException("Form too many keys");
                         break;
                     case '=':
                         if (key!=null)
