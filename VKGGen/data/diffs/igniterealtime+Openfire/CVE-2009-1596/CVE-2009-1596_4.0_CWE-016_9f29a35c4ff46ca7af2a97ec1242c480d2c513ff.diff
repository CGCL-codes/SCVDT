commit 9f29a35c4ff46ca7af2a97ec1242c480d2c513ff
Author:     Daryl Herzmann <akrherz@gmail.com>
AuthorDate: Tue Jun 16 22:37:40 2009 +0000
Commit:     akrherz <akrherz@b35dd754-fafc-0310-a699-88a17e54d16e>
CommitDate: Tue Jun 16 22:37:40 2009 +0000

    change register.password to xmpp.auth.iqauth to match IQAuthHandler,
    this enforces the admin console setting of disallowing password
    changes JM-1532 and CVE-2009-1596
    
    
    git-svn-id: http://svn.igniterealtime.org/svn/repos/openfire/trunk@11076 b35dd754-fafc-0310-a699-88a17e54d16e

diff --git a/src/java/org/jivesoftware/openfire/handler/IQRegisterHandler.java b/src/java/org/jivesoftware/openfire/handler/IQRegisterHandler.java
index 2c3977a5b..28dfbe6c4 100644
--- a/src/java/org/jivesoftware/openfire/handler/IQRegisterHandler.java
+++ b/src/java/org/jivesoftware/openfire/handler/IQRegisterHandler.java
@@ -147,7 +147,7 @@ public class IQRegisterHandler extends IQHandler implements ServerFeaturesProvid
         // See if in-band registration should be enabled (default is true).
         registrationEnabled = JiveGlobals.getBooleanProperty("register.inband", true);
         // See if users can change their passwords (default is true).
-        canChangePassword = JiveGlobals.getBooleanProperty("register.password", true);
+        canChangePassword = JiveGlobals.getBooleanProperty("xmpp.auth.iqauth", true);
     }
 
     public IQ handleIQ(IQ packet) throws PacketException, UnauthorizedException {
@@ -446,7 +446,7 @@ public class IQRegisterHandler extends IQHandler implements ServerFeaturesProvid
 
     public void setCanChangePassword(boolean allowed) {
         canChangePassword = allowed;
-        JiveGlobals.setProperty("register.password", canChangePassword ? "true" : "false");
+        JiveGlobals.setProperty("xmpp.auth.iqauth", canChangePassword ? "true" : "false");
     }
 
     public IQHandlerInfo getInfo() {
