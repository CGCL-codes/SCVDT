From 8ac74c350779921598f9d5edfed39dd35de8842a Mon Sep 17 00:00:00 2001
From: Vojtech Juranek <vjuranek@redhat.com>
Date: Thu, 13 Jun 2013 21:45:57 +0200
Subject: [PATCH] [FIXED SECURITY-75] Invalidate session after login to avoid
 session fixation

---
 .../java/hudson/security/AuthenticationProcessingFilter2.java    | 1 +
 1 file changed, 1 insertion(+)

diff --git a/core/src/main/java/hudson/security/AuthenticationProcessingFilter2.java b/core/src/main/java/hudson/security/AuthenticationProcessingFilter2.java
index 7f282199e88..1819c771f47 100644
--- a/core/src/main/java/hudson/security/AuthenticationProcessingFilter2.java
+++ b/core/src/main/java/hudson/security/AuthenticationProcessingFilter2.java
@@ -85,6 +85,7 @@ protected void onSuccessfulAuthentication(HttpServletRequest request, HttpServle
         // HttpSessionContextIntegrationFilter stores the updated SecurityContext object into this session later
         // (either when a redirect is issued, via its HttpResponseWrapper, or when the execution returns to its
         // doFilter method.
+        request.getSession().invalidate();
         request.getSession();
     }
 
