diff --git a/batik-dom/src/main/java/org/apache/batik/dom/AbstractDocument.java b/batik-dom/src/main/java/org/apache/batik/dom/AbstractDocument.java
index 1dc3cbb5a8..779d49bb20 100644
--- a/batik-dom/src/main/java/org/apache/batik/dom/AbstractDocument.java
+++ b/batik-dom/src/main/java/org/apache/batik/dom/AbstractDocument.java
@@ -2729,9 +2729,13 @@ private void readObject(ObjectInputStream s)
             Method m = c.getMethod("getDOMImplementation", (Class[])null);
             implementation = (DOMImplementation)m.invoke(null, (Object[])null);
         } catch (Exception e) {
-            try {
-                implementation = (DOMImplementation)c.getDeclaredConstructor().newInstance();
-            } catch (Exception ex) {
+            if (DOMImplementation.class.isAssignableFrom(c)) {
+                try {
+                    implementation = (DOMImplementation)c.getDeclaredConstructor().newInstance();
+                } catch (Exception ex) {
+                }
+            } else {
+                throw new SecurityException("Trying to create object that is not a DOMImplementation.");
             }
         }
     }
