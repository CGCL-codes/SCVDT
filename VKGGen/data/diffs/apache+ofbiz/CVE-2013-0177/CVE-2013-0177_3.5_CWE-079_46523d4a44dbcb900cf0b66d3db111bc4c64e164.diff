commit 46523d4a44dbcb900cf0b66d3db111bc4c64e164
Author:     Jacopo Cappellato <jacopoc@apache.org>
AuthorDate: Mon Jan 14 09:14:57 2013 +0000
Commit:     Jacopo Cappellato <jacopoc@apache.org>
CommitDate: Mon Jan 14 09:14:57 2013 +0000

    Applied fix from trunk for revision: 1432833
    ===
    
    CVE-2013-0177: The Image.alt is now escaped to prevent the risk of an XSS attack.
    
    
    
    git-svn-id: https://svn.apache.org/repos/asf/ofbiz/branches/release10.04@1432846 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/framework/widget/src/org/ofbiz/widget/screen/ModelScreenWidget.java b/framework/widget/src/org/ofbiz/widget/screen/ModelScreenWidget.java
index 354e64f114..40ffe8f08d 100644
--- a/framework/widget/src/org/ofbiz/widget/screen/ModelScreenWidget.java
+++ b/framework/widget/src/org/ofbiz/widget/screen/ModelScreenWidget.java
@@ -1622,7 +1622,12 @@ public abstract class ModelScreenWidget extends ModelWidget {
         }
 
         public String getAlt(Map<String, Object> context) {
-            return this.alt.expandString(context);
+            String alt = this.alt.expandString(context);
+            StringUtil.SimpleEncoder simpleEncoder = (StringUtil.SimpleEncoder) context.get("simpleEncoder");
+            if (simpleEncoder != null) {
+                alt = simpleEncoder.encode(alt);
+            }
+            return alt;
         }
 
         public String getUrlMode() {
