commit 519b4d8766ed3ed17bd94cf90038a043331aa192
Author:     Scott Gray <lektran@apache.org>
AuthorDate: Sun Mar 18 20:51:43 2012 +0000
Commit:     Scott Gray <lektran@apache.org>
CommitDate: Sun Mar 18 20:51:43 2012 +0000

    Backport from trunk r1302218: CVE-2012-1621: Escape errors returned from ajax calls in the checkout pages
    
    git-svn-id: https://svn.apache.org/repos/asf/ofbiz/branches/release11.04@1302221 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/specialpurpose/ecommerce/webapp/ecommerce/images/checkoutProcess.js b/specialpurpose/ecommerce/webapp/ecommerce/images/checkoutProcess.js
index 485459c062..ce3b5f0f20 100644
--- a/specialpurpose/ecommerce/webapp/ecommerce/images/checkoutProcess.js
+++ b/specialpurpose/ecommerce/webapp/ecommerce/images/checkoutProcess.js
@@ -143,12 +143,13 @@ function getServerError(data) {
     var serverError = "";
     if (data._ERROR_MESSAGE_LIST_ != undefined) {
         serverErrorHash = data._ERROR_MESSAGE_LIST_;
-        serverErrorHash.each(function(error) {
-            serverError += error.message;
+        jQuery.each(serverErrorHash, function(i, error) {
+            var encodedErrorMessage = jQuery('<div/>').text(error.message).html();
+            serverError += encodedErrorMessage + '<br/>';
         });
     }
     if (data._ERROR_MESSAGE_ != undefined) {
-        serverError = data._ERROR_MESSAGE_;
+        serverError = jQuery('<div/>').text(data._ERROR_MESSAGE_).html();
     }
     return serverError;
 }
