commit f6cbadcf1382c1a1ab4c7e95ab34945486eb5d86
Author:     Scott Gray <lektran@apache.org>
AuthorDate: Sun Mar 18 20:31:10 2012 +0000
Commit:     Scott Gray <lektran@apache.org>
CommitDate: Sun Mar 18 20:31:10 2012 +0000

    CVE-2012-1621: Escape errors returned from ajax calls in the checkout pages
    
    git-svn-id: https://svn.apache.org/repos/asf/ofbiz/trunk@1302218 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/specialpurpose/ecommerce/webapp/ecommerce/images/checkoutProcess.js b/specialpurpose/ecommerce/webapp/ecommerce/images/checkoutProcess.js
index 4e41c2ad97..db72cc8069 100644
--- a/specialpurpose/ecommerce/webapp/ecommerce/images/checkoutProcess.js
+++ b/specialpurpose/ecommerce/webapp/ecommerce/images/checkoutProcess.js
@@ -144,11 +144,12 @@ function getServerError(data) {
     if (data._ERROR_MESSAGE_LIST_ != undefined) {
         serverErrorHash = data._ERROR_MESSAGE_LIST_;
         jQuery.each(serverErrorHash, function(i, error) {
-            serverError += error.message + '<br/>';
+            var encodedErrorMessage = jQuery('<div/>').text(error.message).html();
+            serverError += encodedErrorMessage + '<br/>';
         });
     }
     if (data._ERROR_MESSAGE_ != undefined) {
-        serverError = data._ERROR_MESSAGE_;
+        serverError = jQuery('<div/>').text(data._ERROR_MESSAGE_).html();
     }
     return serverError;
 }
