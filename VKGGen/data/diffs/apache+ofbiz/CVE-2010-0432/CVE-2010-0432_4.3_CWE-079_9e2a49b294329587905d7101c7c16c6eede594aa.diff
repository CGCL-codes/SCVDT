commit 9e2a49b294329587905d7101c7c16c6eede594aa
Author:     Scott Gray <lektran@apache.org>
AuthorDate: Mon Mar 8 16:10:54 2010 +0000
Commit:     Scott Gray <lektran@apache.org>
CommitDate: Mon Mar 8 16:10:54 2010 +0000

    [CVE-2010-0432] Merged from trunk r920369:
    Menu widget links of type hidden-form were not correctly encoding the value attribute.
    
    
    git-svn-id: https://svn.apache.org/repos/asf/ofbiz/branches@920379 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/release09.04/framework/widget/src/org/ofbiz/widget/html/HtmlMenuRenderer.java b/release09.04/framework/widget/src/org/ofbiz/widget/html/HtmlMenuRenderer.java
index 599e1798af..c0636b1093 100644
--- a/release09.04/framework/widget/src/org/ofbiz/widget/html/HtmlMenuRenderer.java
+++ b/release09.04/framework/widget/src/org/ofbiz/widget/html/HtmlMenuRenderer.java
@@ -396,11 +396,16 @@ public class HtmlMenuRenderer extends HtmlWidgetRenderer implements MenuStringRe
                 writer.append(uniqueItemName);
                 writer.append("\">");
 
+                StringUtil.SimpleEncoder simpleEncoder = (StringUtil.SimpleEncoder) context.get("simpleEncoder");
                 for (WidgetWorker.Parameter parameter: link.getParameterList()) {
                     writer.append("<input name=\"");
                     writer.append(parameter.getName());
                     writer.append("\" value=\"");
-                    writer.append(parameter.getValue(context));
+                    if (simpleEncoder != null) {
+                        writer.append(simpleEncoder.encode(parameter.getValue(context)));
+                    } else {
+                        writer.append(parameter.getValue(context));
+                    }
                     writer.append("\" type=\"hidden\"/>");
                 }
 
