commit 02832fd37e31ae1602f1605944ede6dacbd33fa4
Author:     Scott Gray <lektran@apache.org>
AuthorDate: Mon Mar 8 16:05:09 2010 +0000
Commit:     Scott Gray <lektran@apache.org>
CommitDate: Mon Mar 8 16:05:09 2010 +0000

    [CVE-2010-0432] Menu widget links of type hidden-form were not correctly encoding the value attribute.
    
    
    git-svn-id: https://svn.apache.org/repos/asf/ofbiz/trunk@920369 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/framework/widget/src/org/ofbiz/widget/html/HtmlMenuRenderer.java b/framework/widget/src/org/ofbiz/widget/html/HtmlMenuRenderer.java
index 656094cc65..dc0384f60d 100644
--- a/framework/widget/src/org/ofbiz/widget/html/HtmlMenuRenderer.java
+++ b/framework/widget/src/org/ofbiz/widget/html/HtmlMenuRenderer.java
@@ -412,11 +412,16 @@ public class HtmlMenuRenderer extends HtmlWidgetRenderer implements MenuStringRe
                 writer.append(uniqueItemName);
                 writer.append("\">");
 
+                StringUtil.SimpleEncoder simpleEncoder = (StringUtil.SimpleEncoder) context.get("simpleEncoder");
                 for (WidgetWorker.Parameter parameter: link.getParameterList()) {
                     writer.append("<input name=\"");
                     writer.append(parameter.getName());
                     writer.append("\" value=\"");
-                    writer.append(parameter.getValue(context));
+                    if (simpleEncoder != null) {
+                        writer.append(simpleEncoder.encode(parameter.getValue(context)));
+                    } else {
+                        writer.append(parameter.getValue(context));
+                    }
                     writer.append("\" type=\"hidden\"/>");
                 }
 
