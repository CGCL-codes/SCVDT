commit 9459656738b497f0c0a551e12b13b7801272767c
Author:     Jacopo Cappellato <jacopoc@apache.org>
AuthorDate: Thu May 2 13:44:31 2019 +0000
Commit:     Jacopo Cappellato <jacopoc@apache.org>
CommitDate: Thu May 2 13:44:31 2019 +0000

    Applied fix from trunk for revision: 1858539
    ===
    
    Improved: Replaced permission-service with required-permissions in order to
    perform permission checks in a way that is more consistent with the screen
    permissions set in the ecommerce blog/forum screens.
    
    Fixes CVE-2019-10073
    
    
    git-svn-id: https://svn.apache.org/repos/asf/ofbiz/branches/release16.11@1858543 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/applications/content/servicedef/services.xml b/applications/content/servicedef/services.xml
index fb2c6b02f6..25b36e3741 100644
--- a/applications/content/servicedef/services.xml
+++ b/applications/content/servicedef/services.xml
@@ -426,7 +426,9 @@
     <service name="createArticleContent" engine="simple" transaction-timeout="300" auth="true"
             location="component://content/minilang/content/ContentServices.xml" invoke="createArticleContent">
         <description>Creates content records for a blog entry</description>
-        <permission-service service-name="genericContentPermission" main-action="CREATE"/>
+        <required-permissions join-type="AND">
+            <check-permission permission="CONTENTMGR" action="_CREATE"/>
+        </required-permissions>
         <implements service="createContentFromUploadedFile" optional="true"/>
         <implements service="createTextContent" optional="true"/>
         <attribute name="contentIdFrom" type="String" mode="IN" optional="false"/>
@@ -821,7 +823,9 @@
     <service name="createBlogEntry" engine="simple" auth="true"
         location="component://content/minilang/blog/BlogServices.xml" invoke="createBlogEntry">
         <description>Creates content records for a blog entry</description>
-        <permission-service service-name="genericContentPermission" main-action="CREATE"/>
+        <required-permissions join-type="AND">
+            <check-permission permission="CONTENTMGR" action="_CREATE"/>
+        </required-permissions>
         <implements service="uploadFileInterface" optional="true"/>
         <attribute name="blogContentId" type="String" mode="INOUT" optional="false"/>
         <attribute name="contentId" type="String" mode="OUT" optional="false"/>
@@ -835,7 +839,9 @@
     <service name="updateBlogEntry" engine="simple" auth="true"
         location="component://content/minilang/blog/BlogServices.xml" invoke="updateBlogEntry">
         <description>Updates content records for a blog entry</description>
-        <permission-service service-name="genericContentPermission" main-action="CREATE"/>
+        <required-permissions join-type="AND">
+            <check-permission permission="CONTENTMGR" action="_UPDATE"/>
+        </required-permissions>
         <implements service="uploadFileInterface" optional="true"/>
         <attribute name="blogContentId" type="String" mode="INOUT" optional="false"/>
         <attribute name="contentId" type="String" mode="INOUT" optional="false"/>
