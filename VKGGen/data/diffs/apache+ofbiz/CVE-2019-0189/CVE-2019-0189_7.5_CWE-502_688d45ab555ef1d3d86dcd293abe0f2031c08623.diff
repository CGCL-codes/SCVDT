commit 688d45ab555ef1d3d86dcd293abe0f2031c08623
Author:     Jacques Le Roux <jleroux@apache.org>
AuthorDate: Thu Mar 28 15:37:10 2019 +0000
Commit:     Jacques Le Roux <jleroux@apache.org>
CommitDate: Thu Mar 28 15:37:10 2019 +0000

    "Applied fix from trunk framework for revision: 1856484"
    ------------------------------------------------------------------------
    r1856484 | jleroux | 2019-03-28 16:36:13 +0100 (jeu. 28 mars 2019) | 13 lignes
    
    Improved: Improve ObjectInputStream class
    (OFBIZ-10837)
    
    Fixes CVE-2019-0189
    
    The white list was still not complete as reported by Ed Mack
    This adds
    org.apache.ofbiz.widget.model.ModelTheme
    java.util.Collections
    java.util.LinkedList
    java.util.ArrayList
    java.util.TimeZonz
    
    
    Thanks: Ed Mack at OFBIZ-10876
    ------------------------------------------------------------------------
    
    
    git-svn-id: https://svn.apache.org/repos/asf/ofbiz/branches/release16.11@1856487 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/framework/base/src/main/java/org/apache/ofbiz/base/util/UtilObject.java b/framework/base/src/main/java/org/apache/ofbiz/base/util/UtilObject.java
index 36baa40836..0c0e589a11 100644
--- a/framework/base/src/main/java/org/apache/ofbiz/base/util/UtilObject.java
+++ b/framework/base/src/main/java/org/apache/ofbiz/base/util/UtilObject.java
@@ -149,7 +149,10 @@ public final class UtilObject {
                                 "java.util.HashMap", "Boolean", "Number", "Integer", "FlexibleStringExpander",
                                 "sun.util.calendar.ZoneInfo", "java.sql.Timestamp", "java.util.Date",
                                 "java.math.BigDecimal", "\\[Z","\\[B","\\[S","\\[I","\\[J","\\[F","\\[D","\\[C",
-                                "org.apache.ofbiz.widget.renderer.VisualTheme"));) {
+                                "org.apache.ofbiz.widget.renderer.VisualTheme",
+                                "org.apache.ofbiz.widget.model.ModelTheme",
+                                "java.util.Collections", "java.util.LinkedList", "java.util.ArrayList",
+                                "java.util.TimeZone"));) {
             return wois.readObject();
         }
     }
