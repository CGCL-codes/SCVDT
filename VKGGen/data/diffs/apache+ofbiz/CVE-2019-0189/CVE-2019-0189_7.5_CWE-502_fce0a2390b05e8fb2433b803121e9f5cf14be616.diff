commit fce0a2390b05e8fb2433b803121e9f5cf14be616
Author:     Jacques Le Roux <jleroux@apache.org>
AuthorDate: Tue Mar 12 08:30:07 2019 +0000
Commit:     Jacques Le Roux <jleroux@apache.org>
CommitDate: Tue Mar 12 08:30:07 2019 +0000

    "Applied fix from trunk framework for revision: 1855287"
    ------------------------------------------------------------------------
    r1855287 | jleroux | 2019-03-12 09:29:37 +0100 (mar. 12 mars 2019) | 10 lignes
    
    Improved: Improve ObjectInputStream class
    (OFBIZ-10837)
    
    Fixes CVE-2019-0189
    
    The white list was still not complete as reported by Rohit at OFBIZ-10573
    This adds FlexibleStringExpander
    
    It seems the warning in SafeObjectInputStream::resolveClass is not enough.
    Anyway I'll not change it.
    
    Thanks: Rohit Koushal
    ------------------------------------------------------------------------
    
    
    git-svn-id: https://svn.apache.org/repos/asf/ofbiz/branches/release16.11@1855290 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/framework/base/src/main/java/org/apache/ofbiz/base/util/UtilObject.java b/framework/base/src/main/java/org/apache/ofbiz/base/util/UtilObject.java
index daf68e2ce2..78d0dba961 100644
--- a/framework/base/src/main/java/org/apache/ofbiz/base/util/UtilObject.java
+++ b/framework/base/src/main/java/org/apache/ofbiz/base/util/UtilObject.java
@@ -145,8 +145,9 @@ public final class UtilObject {
         try (ByteArrayInputStream bis = new ByteArrayInputStream(bytes);
                 SafeObjectInputStream wois = new SafeObjectInputStream(bis,
                         Thread.currentThread().getContextClassLoader(),
-                        java.util.Arrays.asList("byte\\[\\]", "Number", "Long", "foo", "SerializationInjector", "java.util.HashMap", "Boolean", "Number", "Integer"));
-                ) { // byte[] used in EntityCrypto::doDecrypt, all others used in UtilObjectTests::testGetObject
+                        java.util.Arrays.asList("byte\\[\\]", "Number", "Long", "foo", "SerializationInjector",
+                                "java.util.HashMap", "Boolean", "Number", "Integer", "FlexibleStringExpander"));) {
+                        // byte[] used in EntityCrypto::doDecrypt, all others used in UtilObjectTests::testGetObject
             return wois.readObject();
         }
     }
