commit bc7e50fe61f1f285a954578794c6a6d7bf6c00fc
Author:     Jacques Le Roux <jleroux@apache.org>
AuthorDate: Wed Mar 27 14:25:06 2019 +0000
Commit:     Jacques Le Roux <jleroux@apache.org>
CommitDate: Wed Mar 27 14:25:06 2019 +0000

    "Applied fix from trunk framework for revision: 1856405"
    ------------------------------------------------------------------------
    r1856405 | jleroux | 2019-03-27 15:16:24 +0100 (mer. 27 mars 2019) | 12 lignes
    
    Improved: Improve ObjectInputStream class
    (OFBIZ-10837)
    
    Fixes CVE-2019-0189
    
    The white list was still not complete as reported by Wolfgang Rauchholz on user
    ML
    This adds java.math.BigDecimal and "[B" (ie [B == byte[] and I don't understand
    why in this case "byte[]" does not work)
    
    It seems the warning in SafeObjectInputStream::resolveClass is not enough.
    Anyway I'll not change it.
    
    Thanks: Ingo Wolfmayr at OFBIZ-10870
    ------------------------------------------------------------------------
    
    
    git-svn-id: https://svn.apache.org/repos/asf/ofbiz/branches/release16.11@1856408 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/framework/base/src/main/java/org/apache/ofbiz/base/util/UtilObject.java b/framework/base/src/main/java/org/apache/ofbiz/base/util/UtilObject.java
index 4024267021..f7875a2a23 100644
--- a/framework/base/src/main/java/org/apache/ofbiz/base/util/UtilObject.java
+++ b/framework/base/src/main/java/org/apache/ofbiz/base/util/UtilObject.java
@@ -147,7 +147,8 @@ public final class UtilObject {
                         Thread.currentThread().getContextClassLoader(),
                         java.util.Arrays.asList("byte\\[\\]", "Number", "Long", "foo", "SerializationInjector",
                                 "java.util.HashMap", "Boolean", "Number", "Integer", "FlexibleStringExpander",
-                                "sun.util.calendar.ZoneInfo", "java.sql.Timestamp", "java.util.Date"));) {
+                                "sun.util.calendar.ZoneInfo", "java.sql.Timestamp", "java.util.Date",
+                                "java.math.BigDecimal", "\\[B"));) {
             return wois.readObject();
         }
     }
