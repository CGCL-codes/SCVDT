commit a2eafc944c84f14afea0db8082f10c8b0db7a96b
Author:     Jacques Le Roux <jleroux@apache.org>
AuthorDate: Wed Mar 13 08:20:08 2019 +0000
Commit:     Jacques Le Roux <jleroux@apache.org>
CommitDate: Wed Mar 13 08:20:08 2019 +0000

    "Applied fix from trunk framework for revision: 1855371"
    ------------------------------------------------------------------------
    r1855371 | jleroux | 2019-03-13 09:19:32 +0100 (mer. 13 mars 2019) | 10 lignes
    
    Improved: Improve ObjectInputStream class
    (OFBIZ-10837)
    
    Fixes CVE-2019-0189
    
    The white list was still not complete as reported by Deepak at OFBIZ-10837
    This adds sun.util.calendar.ZoneInfo
    
    It seems the warning in SafeObjectInputStream::resolveClass is not enough.
    Anyway I'll not change it.
    
    Thanks: Deepak Dexit
    ------------------------------------------------------------------------
    
    
    git-svn-id: https://svn.apache.org/repos/asf/ofbiz/branches/release16.11@1855374 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/framework/base/src/main/java/org/apache/ofbiz/base/util/UtilObject.java b/framework/base/src/main/java/org/apache/ofbiz/base/util/UtilObject.java
index 78d0dba961..3946d70428 100644
--- a/framework/base/src/main/java/org/apache/ofbiz/base/util/UtilObject.java
+++ b/framework/base/src/main/java/org/apache/ofbiz/base/util/UtilObject.java
@@ -146,8 +146,8 @@ public final class UtilObject {
                 SafeObjectInputStream wois = new SafeObjectInputStream(bis,
                         Thread.currentThread().getContextClassLoader(),
                         java.util.Arrays.asList("byte\\[\\]", "Number", "Long", "foo", "SerializationInjector",
-                                "java.util.HashMap", "Boolean", "Number", "Integer", "FlexibleStringExpander"));) {
-                        // byte[] used in EntityCrypto::doDecrypt, all others used in UtilObjectTests::testGetObject
+                                "java.util.HashMap", "Boolean", "Number", "Integer", "FlexibleStringExpander",
+                                "sun.util.calendar.ZoneInfo"));) {
             return wois.readObject();
         }
     }
