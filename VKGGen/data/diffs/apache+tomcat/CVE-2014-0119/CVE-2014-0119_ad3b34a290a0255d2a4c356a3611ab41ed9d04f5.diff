diff --git a/java/org/apache/jasper/compiler/TagPluginManager.java b/java/org/apache/jasper/compiler/TagPluginManager.java
index 3d2f205fe7..007230d930 100644
--- a/java/org/apache/jasper/compiler/TagPluginManager.java
+++ b/java/org/apache/jasper/compiler/TagPluginManager.java
@@ -79,17 +79,17 @@ private void init(ErrorDispatcher err) throws JasperException {
         if (Constants.IS_SECURITY_ENABLED) {
             PrivilegedGetTccl pa = new PrivilegedGetTccl();
             original = AccessController.doPrivileged(pa);
-            } else {
-                original = Thread.currentThread().getContextClassLoader();
-            }
+        } else {
+            original = Thread.currentThread().getContextClassLoader();
+        }
         try {
             if (Constants.IS_SECURITY_ENABLED) {
                 PrivilegedSetTccl pa =
-                        new PrivilegedSetTccl(JspDocumentParser.class.getClassLoader());
+                        new PrivilegedSetTccl(TagPluginManager.class.getClassLoader());
                 AccessController.doPrivileged(pa);
             } else {
                 Thread.currentThread().setContextClassLoader(
-                        JspDocumentParser.class.getClassLoader());
+                        TagPluginManager.class.getClassLoader());
             }
 
             parser = new TagPluginParser(ctxt, blockExternal);
