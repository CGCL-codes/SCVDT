diff --git a/java/org/apache/jasper/compiler/TagPluginManager.java b/java/org/apache/jasper/compiler/TagPluginManager.java
index 007230d930..8e8a49af99 100644
--- a/java/org/apache/jasper/compiler/TagPluginManager.java
+++ b/java/org/apache/jasper/compiler/TagPluginManager.java
@@ -94,16 +94,6 @@ private void init(ErrorDispatcher err) throws JasperException {
 
             parser = new TagPluginParser(ctxt, blockExternal);
 
-        } finally {
-            if (Constants.IS_SECURITY_ENABLED) {
-                PrivilegedSetTccl pa = new PrivilegedSetTccl(original);
-                AccessController.doPrivileged(pa);
-            } else {
-                Thread.currentThread().setContextClassLoader(original);
-            }
-        }
-
-        try {
             Enumeration<URL> urls =
                     ctxt.getClassLoader().getResources(META_INF_JASPER_TAG_PLUGINS_XML);
             if (urls != null) {
@@ -119,6 +109,13 @@ private void init(ErrorDispatcher err) throws JasperException {
             }
         } catch (IOException | SAXException e) {
             throw new JasperException(e);
+        } finally {
+            if (Constants.IS_SECURITY_ENABLED) {
+                PrivilegedSetTccl pa = new PrivilegedSetTccl(original);
+                AccessController.doPrivileged(pa);
+            } else {
+                Thread.currentThread().setContextClassLoader(original);
+            }
         }
 
         Map<String, String> plugins = parser.getPlugins();
