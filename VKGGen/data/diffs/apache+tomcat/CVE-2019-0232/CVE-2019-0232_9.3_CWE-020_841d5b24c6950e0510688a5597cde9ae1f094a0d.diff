commit 841d5b24c6950e0510688a5597cde9ae1f094a0d
Author:     Mark Thomas <markt@apache.org>
AuthorDate: Wed Apr 10 11:25:40 2019 +0100
Commit:     Mark Thomas <markt@apache.org>
CommitDate: Wed Apr 10 11:58:59 2019 +0100

    Disable enableCmdLineArguments be default. Hardening for CVE-2019-0232

diff --git a/java/org/apache/catalina/servlets/CGIServlet.java b/java/org/apache/catalina/servlets/CGIServlet.java
index 967a9d94c1..58a6fdc96e 100644
--- a/java/org/apache/catalina/servlets/CGIServlet.java
+++ b/java/org/apache/catalina/servlets/CGIServlet.java
@@ -317,7 +317,7 @@ public final class CGIServlet extends HttpServlet {
      * See https://tools.ietf.org/html/rfc3875#section-4.4
      * 4.4.  The Script Command Line
      */
-    private boolean enableCmdLineArguments = true;
+    private boolean enableCmdLineArguments = false;
 
     /**
      * Limits the encoded form of individual command line arguments. By default
diff --git a/webapps/docs/cgi-howto.xml b/webapps/docs/cgi-howto.xml
index 0fb86bead2..1c4feb7ec3 100644
--- a/webapps/docs/cgi-howto.xml
+++ b/webapps/docs/cgi-howto.xml
@@ -119,7 +119,7 @@ The default matches the allowed values defined by RFC3875 and is
 <code>[a-zA-Z0-9\Q%;/?:@&amp;,$-_.!~*'()\E]+</code></li>
 <li><strong>enableCmdLineArguments</strong> - Are command line arguments
 generated from the query string as per section 4.4 of 3875 RFC? The default is
-<code>true</code>.</li>
+<code>false</code>.</li>
 <li><strong>environment-variable-</strong> - An environment to be set for the
 execution environment of the CGI script. The name of variable is taken from the
 parameter name. To configure an environment variable named FOO, configure a
diff --git a/webapps/docs/changelog.xml b/webapps/docs/changelog.xml
index 6b3a032273..77b0660453 100644
--- a/webapps/docs/changelog.xml
+++ b/webapps/docs/changelog.xml
@@ -152,6 +152,11 @@
         new initialisation parameter <code>cmdLineArgumentsDecoded</code>. This
         is the fix for CVE-2019-0232. (markt)
       </add>
+      <update>
+        Change the default for the <code>enableCmdLineArguments</code> parameter
+        of the CGI servlet from <code>true</code> to <code>false</code> as
+        additional hardening against CVE-2019-0232. (markt)
+      </update>
     </changelog>
   </subsection>
   <subsection name="Coyote">
