Index: tc7.0.x/trunk/java/org/apache/catalina/authenticator/FormAuthenticator.java
===================================================================
--- tc7.0.x/trunk/java/org/apache/catalina/authenticator/FormAuthenticator.java	(revision 1785776)
+++ tc7.0.x/trunk/java/org/apache/catalina/authenticator/FormAuthenticator.java	(revision 1785777)
@@ -406,9 +406,9 @@
         RequestDispatcher disp =
             context.getServletContext().getRequestDispatcher(loginPage);
         try {
-            if (context.fireRequestInitEvent(request)) {
+            if (context.fireRequestInitEvent(request.getRequest())) {
                 disp.forward(request.getRequest(), response);
-                context.fireRequestDestroyEvent(request);
+                context.fireRequestDestroyEvent(request.getRequest());
             }
         } catch (Throwable t) {
             ExceptionUtils.handleThrowable(t);
@@ -450,12 +450,11 @@
         }
 
         RequestDispatcher disp =
-            context.getServletContext().getRequestDispatcher
-            (config.getErrorPage());
+                context.getServletContext().getRequestDispatcher(config.getErrorPage());
         try {
-            if (context.fireRequestInitEvent(request)) {
+            if (context.fireRequestInitEvent(request.getRequest())) {
                 disp.forward(request.getRequest(), response);
-                context.fireRequestDestroyEvent(request);
+                context.fireRequestDestroyEvent(request.getRequest());
             }
         } catch (Throwable t) {
             ExceptionUtils.handleThrowable(t);
Index: tc7.0.x/trunk/java/org/apache/catalina/core/AsyncContextImpl.java
===================================================================
--- tc7.0.x/trunk/java/org/apache/catalina/core/AsyncContextImpl.java	(revision 1785776)
+++ tc7.0.x/trunk/java/org/apache/catalina/core/AsyncContextImpl.java	(revision 1785777)
@@ -135,7 +135,7 @@
                 }
             }
         } finally {
-            context.fireRequestDestroyEvent(request);
+            context.fireRequestDestroyEvent(request.getRequest());
             clearServletRequestResponse();
             if (Globals.IS_SECURITY_ENABLED) {
                 PrivilegedAction<Void> pa = new PrivilegedSetTccl(oldCL);
Index: tc7.0.x/trunk/java/org/apache/catalina/core/StandardHostValve.java
===================================================================
--- tc7.0.x/trunk/java/org/apache/catalina/core/StandardHostValve.java	(revision 1785776)
+++ tc7.0.x/trunk/java/org/apache/catalina/core/StandardHostValve.java	(revision 1785777)
@@ -66,7 +66,7 @@
 
     static {
         STRICT_SERVLET_COMPLIANCE = Globals.STRICT_SERVLET_COMPLIANCE;
-        
+
         String accessSession = System.getProperty(
                 "org.apache.catalina.core.StandardHostValve.ACCESS_SESSION");
         if (accessSession == null) {
@@ -146,7 +146,7 @@
             if (Globals.IS_SECURITY_ENABLED) {
                 PrivilegedAction<Void> pa = new PrivilegedSetTccl(
                         context.getLoader().getClassLoader());
-                AccessController.doPrivileged(pa);                
+                AccessController.doPrivileged(pa);
             } else {
                 Thread.currentThread().setContextClassLoader
                         (context.getLoader().getClassLoader());
@@ -156,9 +156,9 @@
             request.setAsyncSupported(context.getPipeline().isAsyncSupported());
         }
 
-        boolean asyncAtStart = request.isAsync(); 
+        boolean asyncAtStart = request.isAsync();
         boolean asyncDispatching = request.isAsyncDispatching();
-        if (asyncAtStart || context.fireRequestInitEvent(request)) {
+        if (asyncAtStart || context.fireRequestInitEvent(request.getRequest())) {
 
             // Ask this Context to process this request. Requests that are in
             // async mode and are not being dispatched to this resource must be
@@ -197,7 +197,7 @@
             if (!context.getState().isAvailable()) {
                 return;
             }
-    
+
             // Look for (and render if found) an application level error page
             if (response.isErrorReportRequired()) {
                 if (t != null) {
@@ -208,7 +208,7 @@
             }
 
             if (!request.isAsync() && !asyncAtStart) {
-                context.fireRequestDestroyEvent(request);
+                context.fireRequestDestroyEvent(request.getRequest());
             }
         }
 
@@ -222,7 +222,7 @@
         if (Globals.IS_SECURITY_ENABLED) {
             PrivilegedAction<Void> pa = new PrivilegedSetTccl(
                     StandardHostValve.class.getClassLoader());
-            AccessController.doPrivileged(pa);                
+            AccessController.doPrivileged(pa);
         } else {
             Thread.currentThread().setContextClassLoader
                     (StandardHostValve.class.getClassLoader());
@@ -258,7 +258,7 @@
         // Ask this Context to process this request
         context.getPipeline().getFirst().event(request, response, event);
 
-        
+
         // Error page processing
         response.setSuspended(false);
 
@@ -469,7 +469,7 @@
 
             if (response.isCommitted()) {
                 // Response is committed - including the error page is the
-                // best we can do 
+                // best we can do
                 rd.include(request.getRequest(), response.getResponse());
             } else {
                 // Reset the response (keeping the real error code and message)
Index: tc7.0.x/trunk/webapps/docs/changelog.xml
===================================================================
--- tc7.0.x/trunk/webapps/docs/changelog.xml	(revision 1785776)
+++ tc7.0.x/trunk/webapps/docs/changelog.xml	(revision 1785777)
@@ -193,6 +193,10 @@
         session - if there is a session - when running under a
         <code>SecurityManager</code>. Patch provided by Jan Engehausen. (markt)
       </fix>
+      <fix>
+        Ensure request and response facades are used when firing application
+        listeners. (markt/remm)
+      </fix>
     </changelog>
   </subsection>
 </section>
Index: tc7.0.x/trunk
===================================================================
--- tc7.0.x/trunk	(revision 1785776)
+++ tc7.0.x/trunk	(revision 1785777)

Property changes on: tc7.0.x/trunk
___________________________________________________________________
Modified: svn:mergeinfo
## -0,0 +0,2 ##
   Merged /tomcat/trunk:r1785774
   Merged /tomcat/tc8.5.x/trunk:r1785775
