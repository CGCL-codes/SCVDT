Index: tc6.0.x/trunk/java/org/apache/catalina/realm/DataSourceRealm.java
===================================================================
--- tc6.0.x/trunk/java/org/apache/catalina/realm/DataSourceRealm.java	(revision 747839)
+++ tc6.0.x/trunk/java/org/apache/catalina/realm/DataSourceRealm.java	(revision 747840)
@@ -270,8 +270,9 @@
      */
     public Principal authenticate(String username, String credentials) {
     	
-    	// No user - can't possibly authenticate, don't bother the database then
-    	if (username == null) {
+    	// No user or no credentials
+        // Can't possibly authenticate, don't bother the database then
+    	if (username == null || credentials == null) {
     		return null;
     	}
         
Index: tc6.0.x/trunk/java/org/apache/catalina/realm/JDBCRealm.java
===================================================================
--- tc6.0.x/trunk/java/org/apache/catalina/realm/JDBCRealm.java	(revision 747839)
+++ tc6.0.x/trunk/java/org/apache/catalina/realm/JDBCRealm.java	(revision 747840)
@@ -393,9 +393,10 @@
                                                String username,
                                                String credentials) {
 
-        // No user - can't possibly authenticate
-        if (username == null) {
-            return (null);
+        // No user or no credentials
+        // Can't possibly authenticate, don't bother the database then
+        if (username == null || credentials == null) {
+            return null;
         }
 
         // Look up the user's credentials
Index: tc6.0.x/trunk/java/org/apache/catalina/realm/MemoryRealm.java
===================================================================
--- tc6.0.x/trunk/java/org/apache/catalina/realm/MemoryRealm.java	(revision 747839)
+++ tc6.0.x/trunk/java/org/apache/catalina/realm/MemoryRealm.java	(revision 747840)
@@ -148,7 +148,7 @@
             (GenericPrincipal) principals.get(username);
 
         boolean validated = false;
-        if (principal != null) {
+        if (principal != null && credentials != null) {
             if (hasMessageDigest()) {
                 // Hex hashes should be compared case-insensitive
                 validated = (digest(credentials)
