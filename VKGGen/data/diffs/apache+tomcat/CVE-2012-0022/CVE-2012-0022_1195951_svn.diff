Index: tc7.0.x/trunk/java/org/apache/tomcat/util/http/Parameters.java
===================================================================
--- tc7.0.x/trunk/java/org/apache/tomcat/util/http/Parameters.java	(revision 1195950)
+++ tc7.0.x/trunk/java/org/apache/tomcat/util/http/Parameters.java	(revision 1195951)
@@ -331,18 +331,16 @@
                 String value;
 
                 if (decodeName) {
-                    name = urlDecode(tmpName, charset);
-                } else {
-                    tmpName.setCharset(charset);
-                    name = tmpName.toString();
+                    urlDecode(tmpName);
                 }
+                tmpName.setCharset(charset);
+                name = tmpName.toString();
 
                 if (decodeValue) {
-                    value = urlDecode(tmpValue, charset);
-                } else {
-                    tmpValue.setCharset(charset);
-                    value = tmpValue.toString();
+                    urlDecode(tmpValue);
                 }
+                tmpValue.setCharset(charset);
+                value = tmpValue.toString();
 
                 addParameter(name, value);
             } catch (IOException e) {
@@ -373,14 +371,12 @@
         }
     }
 
-    private String urlDecode(ByteChunk bc, Charset charset)
+    private void urlDecode(ByteChunk bc)
         throws IOException {
         if( urlDec==null ) {
             urlDec=new UDecoder();   
         }
         urlDec.convert(bc);
-        bc.setCharset(charset);
-        return bc.toString();
     }
 
     public void processParameters( MessageBytes data, String encoding ) {
Index: tc7.0.x/trunk
===================================================================
--- tc7.0.x/trunk	(revision 1195950)
+++ tc7.0.x/trunk	(revision 1195951)

Property changes on: tc7.0.x/trunk
___________________________________________________________________
Modified: svn:mergeinfo
## -0,0 +0,1 ##
   Merged /tomcat/trunk:r1195949
