Index: tc8.0.x/trunk/java/org/apache/jasper/runtime/PageContextImpl.java
===================================================================
--- tc8.0.x/trunk/java/org/apache/jasper/runtime/PageContextImpl.java	(revision 1645641)
+++ tc8.0.x/trunk/java/org/apache/jasper/runtime/PageContextImpl.java	(revision 1645642)
@@ -929,37 +929,11 @@
             final Class<?> expectedType, final PageContext pageContext,
             final ProtectedFunctionMapper functionMap)
             throws ELException {
-        Object retValue;
         final ExpressionFactory exprFactory = jspf.getJspApplicationContext(pageContext.getServletContext()).getExpressionFactory();
-        if (SecurityUtil.isPackageProtectionEnabled()) {
-            try {
-                retValue = AccessController
-                        .doPrivileged(new PrivilegedExceptionAction<Object>() {
-
-                            @Override
-                            public Object run() throws Exception {
-                                ELContextImpl ctx = (ELContextImpl) pageContext.getELContext();
-                                ctx.setFunctionMapper(functionMap);
-                                ValueExpression ve = exprFactory.createValueExpression(ctx, expression, expectedType);
-                                return ve.getValue(ctx);
-                            }
-                        });
-            } catch (PrivilegedActionException ex) {
-                Exception realEx = ex.getException();
-                if (realEx instanceof ELException) {
-                    throw (ELException) realEx;
-                } else {
-                    throw new ELException(realEx);
-                }
-            }
-        } else {
-            ELContextImpl ctx = (ELContextImpl) pageContext.getELContext();
-            ctx.setFunctionMapper(functionMap);
-            ValueExpression ve = exprFactory.createValueExpression(ctx, expression, expectedType);
-            retValue = ve.getValue(ctx);
-        }
-
-        return retValue;
+        ELContextImpl ctx = (ELContextImpl) pageContext.getELContext();
+        ctx.setFunctionMapper(functionMap);
+        ValueExpression ve = exprFactory.createValueExpression(ctx, expression, expectedType);
+        return ve.getValue(ctx);
     }
 
     @Override
Index: tc8.0.x/trunk/java/org/apache/jasper/security/SecurityClassLoad.java
===================================================================
--- tc8.0.x/trunk/java/org/apache/jasper/security/SecurityClassLoad.java	(revision 1645641)
+++ tc8.0.x/trunk/java/org/apache/jasper/security/SecurityClassLoad.java	(revision 1645642)
@@ -91,8 +91,6 @@
                 "runtime.PageContextImpl$11");
             loader.loadClass( basePackage +
                 "runtime.PageContextImpl$12");
-            loader.loadClass( basePackage +
-                "runtime.PageContextImpl$13");
 
             loader.loadClass( basePackage +
                 "runtime.JspContextWrapper");
Index: tc8.0.x/trunk
===================================================================
--- tc8.0.x/trunk	(revision 1645641)
+++ tc8.0.x/trunk	(revision 1645642)

Property changes on: tc8.0.x/trunk
___________________________________________________________________
Modified: svn:mergeinfo
## -0,0 +0,1 ##
   Merged /tomcat/trunk:r1645641
