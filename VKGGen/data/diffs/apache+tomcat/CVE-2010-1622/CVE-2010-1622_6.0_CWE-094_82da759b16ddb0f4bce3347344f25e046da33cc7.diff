commit 82da759b16ddb0f4bce3347344f25e046da33cc7
Author:     Mark Thomas <markt@apache.org>
AuthorDate: Wed Jul 21 16:09:41 2010 +0000
Commit:     Mark Thomas <markt@apache.org>
CommitDate: Wed Jul 21 16:09:41 2010 +0000

    Return copies of the URL array rather than the original. This facilitated CVE-2010-1622 although the root cause was in the Spring Framework. Returning a copy in this case seems like a good idea.
    
    git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@966292 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/java/org/apache/catalina/loader/WebappClassLoader.java b/java/org/apache/catalina/loader/WebappClassLoader.java
index 85ccaab483..8090e905d4 100644
--- a/java/org/apache/catalina/loader/WebappClassLoader.java
+++ b/java/org/apache/catalina/loader/WebappClassLoader.java
@@ -1709,7 +1709,7 @@ public class WebappClassLoader
     public URL[] getURLs() {
 
         if (repositoryURLs != null) {
-            return repositoryURLs;
+            return repositoryURLs.clone();
         }
 
         URL[] external = super.getURLs();
@@ -1749,7 +1749,7 @@ public class WebappClassLoader
             repositoryURLs = new URL[0];
         }
 
-        return repositoryURLs;
+        return repositoryURLs.clone();
 
     }
 
