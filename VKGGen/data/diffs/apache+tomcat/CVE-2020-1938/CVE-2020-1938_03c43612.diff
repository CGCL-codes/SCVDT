commit 03c436126db6794db5277a3b3d871016fb9a3f23
Author:     Mark Thomas <markt@apache.org>
AuthorDate: Wed Feb 5 14:47:48 2020 +0000
Commit:     Mark Thomas <markt@apache.org>
CommitDate: Wed Feb 5 14:50:24 2020 +0000

    Refactor secret check
    
    Moving the check to start allows invalid configurations to be fixed via
    JMX and changes to be made followed by stop()/start() for those changes
    to take effect.

diff --git a/java/org/apache/coyote/ajp/AbstractAjpProtocol.java b/java/org/apache/coyote/ajp/AbstractAjpProtocol.java
index 679071378e..641ec184de 100644
--- a/java/org/apache/coyote/ajp/AbstractAjpProtocol.java
+++ b/java/org/apache/coyote/ajp/AbstractAjpProtocol.java
@@ -267,13 +267,13 @@ public abstract class AbstractAjpProtocol<S> extends AbstractProtocol<S> {
 
 
     @Override
-    public void init() throws Exception {
+    public void start() throws Exception {
         if (getSecretRequired()) {
             String secret = getSecret();
             if (secret == null || secret.length() == 0) {
                 throw new IllegalArgumentException(sm.getString("ajpprotocol.nosecret"));
             }
         }
-        super.init();
+        super.start();
     }
 }
