commit 49ad3f954f69c6e838c8cd112ad79aa5fa8e7153
Author:     Mark Thomas <markt@apache.org>
AuthorDate: Wed Feb 5 14:47:48 2020 +0000
Commit:     Mark Thomas <markt@apache.org>
CommitDate: Wed Feb 5 14:49:50 2020 +0000

    Refactor secret check
    
    Moving the check to start allows invalid configurations to be fixed via
    JMX and changes to be made followed by stop()/start() for those changes
    to take effect.

diff --git a/java/org/apache/coyote/ajp/AbstractAjpProtocol.java b/java/org/apache/coyote/ajp/AbstractAjpProtocol.java
index 63ff6c5a63..7cfdf0accf 100644
--- a/java/org/apache/coyote/ajp/AbstractAjpProtocol.java
+++ b/java/org/apache/coyote/ajp/AbstractAjpProtocol.java
@@ -257,13 +257,13 @@ public abstract class AbstractAjpProtocol<S> extends AbstractProtocol<S> {
 
 
     @Override
-    public void init() throws Exception {
+    public void start() throws Exception {
         if (getSecretRequired()) {
             String secret = getSecret();
             if (secret == null || secret.length() == 0) {
                 throw new IllegalArgumentException(sm.getString("ajpprotocol.nosecret"));
             }
         }
-        super.init();
+        super.start();
     }
 }
