Index: tc6.0.x/trunk/java/org/apache/jk/common/ChannelSocket.java
===================================================================
--- tc6.0.x/trunk/java/org/apache/jk/common/ChannelSocket.java	(revision 742914)
+++ tc6.0.x/trunk/java/org/apache/jk/common/ChannelSocket.java	(revision 742915)
@@ -45,6 +45,7 @@
 import org.apache.coyote.Request;
 import org.apache.coyote.RequestGroupInfo;
 import org.apache.coyote.RequestInfo;
+import org.apache.coyote.ActionCode;
 import org.apache.tomcat.util.modeler.Registry;
 import org.apache.tomcat.util.threads.ThreadPool;
 import org.apache.tomcat.util.threads.ThreadPoolRunnable;
@@ -697,6 +698,7 @@
                 status= this.invoke( recv, ep );
                 if( status!= JkHandler.OK ) {
                     log.warn("processCallbacks status " + status );
+                    ep.action(ActionCode.ACTION_CLOSE, ep.getRequest().getResponse());
                     break;
                 }
             }
Index: tc6.0.x/trunk/java/org/apache/jk/common/HandlerRequest.java
===================================================================
--- tc6.0.x/trunk/java/org/apache/jk/common/HandlerRequest.java	(revision 742914)
+++ tc6.0.x/trunk/java/org/apache/jk/common/HandlerRequest.java	(revision 742915)
@@ -265,8 +265,16 @@
                                  ((Request)ep.getRequest()).unparsedURI());
                 }
             } catch( Exception ex ) {
+                /* If we are here it is because we have a bad header or something like that */
                 log.error( "Error decoding request ", ex );
                 msg.dump( "Incomming message");
+                Response res=ep.getRequest().getResponse();
+                if ( res==null ) {
+                    res=new Response();
+                    ep.getRequest().setResponse(res);
+                }
+                res.setMessage("Bad Request");
+                res.setStatus(400);
                 return ERROR;
             }
 
Index: tc6.0.x/trunk/java/org/apache/jk/common/ChannelNioSocket.java
===================================================================
--- tc6.0.x/trunk/java/org/apache/jk/common/ChannelNioSocket.java	(revision 742914)
+++ tc6.0.x/trunk/java/org/apache/jk/common/ChannelNioSocket.java	(revision 742915)
@@ -56,6 +56,7 @@
 import org.apache.coyote.Request;
 import org.apache.coyote.RequestGroupInfo;
 import org.apache.coyote.RequestInfo;
+import org.apache.coyote.ActionCode;
 import org.apache.tomcat.util.threads.ThreadPool;
 import org.apache.tomcat.util.threads.ThreadPoolRunnable;
 
@@ -854,6 +855,7 @@
                     status= invoke( recv, ep );
                     if( status != JkHandler.OK ) {
                         log.warn("processCallbacks status " + status );
+                        ep.action(ActionCode.ACTION_CLOSE, ep.getRequest().getResponse());
                         return false;
                     }
                     synchronized(this) {
Index: tc6.0.x/trunk/STATUS.txt
===================================================================
--- tc6.0.x/trunk/STATUS.txt	(revision 742914)
+++ tc6.0.x/trunk/STATUS.txt	(revision 742915)
@@ -155,10 +155,6 @@
                  Haven't checked what the other ones will do
   -1: 
 
-* Make sure the 400 is returned to the browser. (like other connectors).
-  http://people.apache.org/~jfclere/patches/patch400.1.txt
-  +1: jfclere, fhanik, remm
-
 * Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=38570
   When checking docBase against appBase, make sure we check for an exact match
   against the appBase
