commit b83bb0997ca98773c8bf58bd3ea053b6293c8150
Author:     Mark Thomas <markt@apache.org>
AuthorDate: Thu Dec 17 21:06:14 2015 +0000
Commit:     Mark Thomas <markt@apache.org>
CommitDate: Thu Dec 17 21:06:14 2015 +0000

    Don't create session unnecessarily in the Host Manager application
    This is part 2 of 2 of the fix for CVE-2015-5351
    
    git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1720655 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/webapps/docs/changelog.xml b/webapps/docs/changelog.xml
index 630c0f2155..8d13a737c1 100644
--- a/webapps/docs/changelog.xml
+++ b/webapps/docs/changelog.xml
@@ -247,6 +247,10 @@
       <fix>
         Don't create session unnecessarily in the Manager application. (markt)
       </fix>
+      <fix>
+        Don't create session unnecessarily in the Host Manager application.
+        (markt)
+      </fix>
     </changelog>
   </subsection>
   <subsection name="Tribes">
diff --git a/webapps/host-manager/WEB-INF/jsp/401.jsp b/webapps/host-manager/WEB-INF/jsp/401.jsp
index 83c8c6f32f..047766bbf9 100644
--- a/webapps/host-manager/WEB-INF/jsp/401.jsp
+++ b/webapps/host-manager/WEB-INF/jsp/401.jsp
@@ -14,6 +14,7 @@
   See the License for the specific language governing permissions and
   limitations under the License.
 --%>
+<%@ page session="false" trimDirectiveWhitespaces="true" %>
 <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
 <html>
  <head>
diff --git a/webapps/host-manager/WEB-INF/jsp/403.jsp b/webapps/host-manager/WEB-INF/jsp/403.jsp
index 2dbb448484..5eff6f06ea 100644
--- a/webapps/host-manager/WEB-INF/jsp/403.jsp
+++ b/webapps/host-manager/WEB-INF/jsp/403.jsp
@@ -14,6 +14,7 @@
   See the License for the specific language governing permissions and
   limitations under the License.
 --%>
+<%@ page session="false" trimDirectiveWhitespaces="true" %>
 <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
 <html>
  <head>
diff --git a/webapps/host-manager/WEB-INF/jsp/404.jsp b/webapps/host-manager/WEB-INF/jsp/404.jsp
index d1b5b0b09a..9816df590a 100644
--- a/webapps/host-manager/WEB-INF/jsp/404.jsp
+++ b/webapps/host-manager/WEB-INF/jsp/404.jsp
@@ -14,7 +14,8 @@
   See the License for the specific language governing permissions and
   limitations under the License.
 --%>
-<%@ page import="org.apache.catalina.util.RequestUtil" %>
+<%@ page import="org.apache.catalina.util.RequestUtil" session="false"
+         trimDirectiveWhitespaces="true" %>
 <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
 <html>
  <head>
diff --git a/webapps/host-manager/index.jsp b/webapps/host-manager/index.jsp
index d4816e5a22..2806b76e8e 100644
--- a/webapps/host-manager/index.jsp
+++ b/webapps/host-manager/index.jsp
@@ -14,5 +14,5 @@
   See the License for the specific language governing permissions and
   limitations under the License.
 --%>
-<% response.sendRedirect(response.encodeRedirectURL(request.getContextPath() +
-        "/html")); %>
\ No newline at end of file
+<%@ page session="false" trimDirectiveWhitespaces="true" %>
+<% response.sendRedirect(request.getContextPath() + "/html"); %>
\ No newline at end of file
