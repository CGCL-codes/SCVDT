Index: tc7.0.x/trunk/java/org/apache/catalina/realm/RealmBase.java
===================================================================
--- tc7.0.x/trunk/java/org/apache/catalina/realm/RealmBase.java	(revision 1823308)
+++ tc7.0.x/trunk/java/org/apache/catalina/realm/RealmBase.java	(revision 1823309)
@@ -688,9 +688,9 @@
 
         // Check each defined security constraint
         String uri = request.getRequestPathMB().toString();
-        // Bug47080 - in rare cases this may be null
+        // Bug47080 - in rare cases this may be null or ""
         // Mapper treats as '/' do the same to prevent NPE
-        if (uri == null) {
+        if (uri == null || uri.length() == 0) {
             uri = "/";
         }
 
@@ -722,7 +722,8 @@
                 }
 
                 for(int k=0; k < patterns.length; k++) {
-                    if(uri.equals(patterns[k])) {
+                    // Exact match including special case for the context root.
+                    if(uri.equals(patterns[k]) || patterns[k].length() == 0 && uri.equals("/")) {
                         found = true;
                         if(collection[j].findMethod(method)) {
                             if(results == null) {
Index: tc7.0.x/trunk/webapps/docs/changelog.xml
===================================================================
--- tc7.0.x/trunk/webapps/docs/changelog.xml	(revision 1823308)
+++ tc7.0.x/trunk/webapps/docs/changelog.xml	(revision 1823309)
@@ -82,6 +82,10 @@
         rather than the user facing Principal object as Tomcat requires the
         internal object to correctly process later authorization checks. (markt)
       </fix>
+      <fix>
+        <bug>62067</bug>: Correctly apply security constraints mapped to the
+        context root using a URL pattern of <code>&quot;&quot;</code>. (markt)
+      </fix>
     </changelog>
   </subsection>
   <subsection name="Other">
Index: tc7.0.x/trunk
===================================================================
--- tc7.0.x/trunk	(revision 1823308)
+++ tc7.0.x/trunk	(revision 1823309)

Property changes on: tc7.0.x/trunk
___________________________________________________________________
Modified: svn:mergeinfo
## -0,0 +0,2 ##
   Merged /tomcat/trunk:r1823306
   Merged /tomcat/tc8.5.x/trunk:r1823307
