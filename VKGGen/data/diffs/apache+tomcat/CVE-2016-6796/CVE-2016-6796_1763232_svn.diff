Index: trunk/java/org/apache/naming/factory/ResourceLinkFactory.java
===================================================================
--- trunk/java/org/apache/naming/factory/ResourceLinkFactory.java	(revision 1763231)
+++ trunk/java/org/apache/naming/factory/ResourceLinkFactory.java	(revision 1763232)
@@ -109,9 +109,12 @@
 
     private static boolean validateGlobalResourceAccess(String globalName) {
         ClassLoader cl = Thread.currentThread().getContextClassLoader();
-        Map<String,String> registrations = globalResourceRegistrations.get(cl);
-        if (registrations != null && registrations.containsValue(globalName)) {
-            return true;
+        while (cl != null) {
+            Map<String,String> registrations = globalResourceRegistrations.get(cl);
+            if (registrations != null && registrations.containsValue(globalName)) {
+                return true;
+            }
+            cl = cl.getParent();
         }
         return false;
     }
Index: trunk/webapps/docs/changelog.xml
===================================================================
--- trunk/webapps/docs/changelog.xml	(revision 1763231)
+++ trunk/webapps/docs/changelog.xml	(revision 1763232)
@@ -102,6 +102,11 @@
         When starting web resources, ensure that class resources are only
         started once. (markt)
       </fix>
+      <fix>
+        Improve the access checks for linked global resources to handle the case
+        where the current class loader is a child of the web application class
+        loader. (markt)
+      </fix>
     </changelog>
   </subsection>
   <subsection name="Coyote">
