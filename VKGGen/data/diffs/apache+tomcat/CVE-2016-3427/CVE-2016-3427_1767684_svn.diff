Index: tc6.0.x/trunk/java/org/apache/catalina/mbeans/JmxRemoteLifecycleListener.java
===================================================================
--- tc6.0.x/trunk/java/org/apache/catalina/mbeans/JmxRemoteLifecycleListener.java	(revision 1767683)
+++ tc6.0.x/trunk/java/org/apache/catalina/mbeans/JmxRemoteLifecycleListener.java	(revision 1767684)
@@ -263,6 +263,10 @@
                 serverCsf = new RmiClientLocalhostSocketFactory(serverCsf);
             }
 
+            env.put("jmx.remote.rmi.server.credential.types", new String[] {
+                    String[].class.getName(),
+                    String.class.getName() });
+
             // Populate the env properties used to create the server
             if (serverCsf != null) {
                 env.put(RMIConnectorServer.RMI_CLIENT_SOCKET_FACTORY_ATTRIBUTE, serverCsf);
@@ -327,7 +331,7 @@
             cs = new RMIConnectorServer(serviceUrl, theEnv, server,
                     ManagementFactory.getPlatformMBeanServer());
             cs.start();
-            registry.bind("jmxrmi", server);
+            registry.bind("jmxrmi", server.toStub());
             log.info(sm.getString("jmxRemoteLifecycleListener.start",
                     Integer.toString(theRmiRegistryPort),
                     Integer.toString(theRmiServerPort), serverName));
Index: tc6.0.x/trunk/webapps/docs/changelog.xml
===================================================================
--- tc6.0.x/trunk/webapps/docs/changelog.xml	(revision 1767683)
+++ tc6.0.x/trunk/webapps/docs/changelog.xml	(revision 1767684)
@@ -51,6 +51,10 @@
         Correctly test for control characters when reading the provided shutdown
         password. (markt)
       </fix>
+      <fix>
+        When configuring the JMX remote listener, specify the allowed types for
+        the credentials. (markt)
+      </fix>
     </changelog>
   </subsection>
   <subsection name="Coyote">
Index: tc6.0.x/trunk
===================================================================
--- tc6.0.x/trunk	(revision 1767683)
+++ tc6.0.x/trunk	(revision 1767684)

Property changes on: tc6.0.x/trunk
___________________________________________________________________
Modified: svn:mergeinfo
## -0,0 +0,3 ##
   Merged /tomcat/tc7.0.x/trunk:r1767676
   Merged /tomcat/tc8.0.x/trunk:r1767656
   Merged /tomcat/trunk:r1767644
