Index: tc8.5.x/trunk/java/org/apache/catalina/mbeans/JmxRemoteLifecycleListener.java
===================================================================
--- tc8.5.x/trunk/java/org/apache/catalina/mbeans/JmxRemoteLifecycleListener.java	(revision 1767645)
+++ tc8.5.x/trunk/java/org/apache/catalina/mbeans/JmxRemoteLifecycleListener.java	(revision 1767646)
@@ -264,6 +264,10 @@
                 serverCsf = new RmiClientLocalhostSocketFactory(serverCsf);
             }
 
+            env.put("jmx.remote.rmi.server.credential.types", new String[] {
+                    String[].class.getName(),
+                    String.class.getName() });
+
             // Populate the env properties used to create the server
             if (serverCsf != null) {
                 env.put(RMIConnectorServer.RMI_CLIENT_SOCKET_FACTORY_ATTRIBUTE, serverCsf);
@@ -328,7 +332,7 @@
             cs = new RMIConnectorServer(serviceUrl, theEnv, server,
                     ManagementFactory.getPlatformMBeanServer());
             cs.start();
-            registry.bind("jmxrmi", server);
+            registry.bind("jmxrmi", server.toStub());
             log.info(sm.getString("jmxRemoteLifecycleListener.start",
                     Integer.toString(theRmiRegistryPort),
                     Integer.toString(theRmiServerPort), serverName));
Index: tc8.5.x/trunk/webapps/docs/changelog.xml
===================================================================
--- tc8.5.x/trunk/webapps/docs/changelog.xml	(revision 1767645)
+++ tc8.5.x/trunk/webapps/docs/changelog.xml	(revision 1767646)
@@ -84,6 +84,10 @@
         <code>o.a.catalina.connector.CoyoteInputStream</code>/
         <code>o.a.catalina.connector.CoyoteOutputStream</code>. (violetagg)
       </add>
+      <fix>
+        When configuring the JMX remote listener, specify the allowed types for
+        the credentials. (markt)
+      </fix>
     </changelog>
   </subsection>
   <subsection name="Coyote">
Index: tc8.5.x/trunk
===================================================================
--- tc8.5.x/trunk	(revision 1767645)
+++ tc8.5.x/trunk	(revision 1767646)

Property changes on: tc8.5.x/trunk
___________________________________________________________________
Modified: svn:mergeinfo
## -0,0 +0,1 ##
   Merged /tomcat/trunk:r1767644
