commit c1357e649641844109711d60cacb98e4b5fcd3cb
Author:     Mark Emlyn David Thomas <markt@apache.org>
AuthorDate: Thu Jun 19 09:26:32 2014 +0000
Commit:     Mark Emlyn David Thomas <markt@apache.org>
CommitDate: Thu Jun 19 09:26:32 2014 +0000

    Correct test. Exceeded the swallow limit aborts the connection.
    
    git-svn-id: https://svn.apache.org/repos/asf/tomcat/trunk@1603775 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/test/org/apache/catalina/core/TestSwallowAbortedUploads.java b/test/org/apache/catalina/core/TestSwallowAbortedUploads.java
index f08f3d765a..44c8ea2c43 100644
--- a/test/org/apache/catalina/core/TestSwallowAbortedUploads.java
+++ b/test/org/apache/catalina/core/TestSwallowAbortedUploads.java
@@ -468,11 +468,12 @@ public class TestSwallowAbortedUploads extends TomcatBaseTest {
 
         if (limit) {
             Assert.assertNotNull(writeEx);
+            Assert.assertNotNull(readEx);
         } else {
             Assert.assertNull(writeEx);
+            Assert.assertNull(readEx);
+            Assert.assertNotNull(responseLine);
+            Assert.assertTrue(responseLine.contains("404"));
         }
-        Assert.assertNull(readEx);
-        Assert.assertNotNull(responseLine);
-        Assert.assertTrue(responseLine.contains("404"));
     }
 }
