commit 4fcdf706f3ecf35912a600242f89637f5acb32da
Author:     Mark Thomas <markt@apache.org>
AuthorDate: Mon Mar 11 11:33:03 2019 +0000
Commit:     Mark Thomas <markt@apache.org>
CommitDate: Wed Apr 10 11:13:18 2019 +0100

    Escape debug output to aid readability

diff --git a/java/org/apache/catalina/ssi/SSIPrintenv.java b/java/org/apache/catalina/ssi/SSIPrintenv.java
index 97470b2d69..092542fae9 100644
--- a/java/org/apache/catalina/ssi/SSIPrintenv.java
+++ b/java/org/apache/catalina/ssi/SSIPrintenv.java
@@ -41,8 +41,7 @@ public class SSIPrintenv implements SSICommand {
         } else {
             Collection<String> variableNames = ssiMediator.getVariableNames();
             for (String variableName : variableNames) {
-                String variableValue = ssiMediator
-                        .getVariableValue(variableName);
+                String variableValue = ssiMediator.getVariableValue(variableName, "entity");
                 //This shouldn't happen, since all the variable names must
                 // have values
                 if (variableValue == null) {
diff --git a/webapps/docs/changelog.xml b/webapps/docs/changelog.xml
index 03c1f5352e..6b542745ee 100644
--- a/webapps/docs/changelog.xml
+++ b/webapps/docs/changelog.xml
@@ -90,6 +90,9 @@
         Tomcat used to resolve standard XML DTDs and schemas when Tomcat is
         configured to validate XML configuration files such as web.xml. (markt)
       </fix>
+      <fix>
+        Encode the output of the SSI <code>printenv</code> command. (markt)
+      </fix>
     </changelog>
   </subsection>
   <subsection name="Coyote">
