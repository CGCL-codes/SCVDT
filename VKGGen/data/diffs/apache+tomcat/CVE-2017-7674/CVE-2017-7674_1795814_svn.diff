Index: tc8.5.x/trunk/java/org/apache/catalina/filters/CorsFilter.java
===================================================================
--- tc8.5.x/trunk/java/org/apache/catalina/filters/CorsFilter.java	(revision 1795813)
+++ tc8.5.x/trunk/java/org/apache/catalina/filters/CorsFilter.java	(revision 1795814)
@@ -286,6 +286,10 @@
                     exposedHeadersString);
         }
 
+        // Indicate the response depends on the origin
+        response.addHeader(CorsFilter.REQUEST_HEADER_VARY,
+                CorsFilter.REQUEST_HEADER_ORIGIN);
+
         // Forward the request down the filter chain.
         filterChain.doFilter(request, response);
     }
@@ -981,7 +985,14 @@
             "Access-Control-Allow-Headers";
 
     // -------------------------------------------------- CORS Request Headers
+
     /**
+     * The Vary header indicates allows disabling proxy caching by indicating
+     * the the response depends on the origin.
+     */
+    public static final String REQUEST_HEADER_VARY = "Vary";
+
+    /**
      * The Origin header indicates where the cross-origin request or preflight
      * request originates from.
      */
Index: tc8.5.x/trunk/webapps/docs/changelog.xml
===================================================================
--- tc8.5.x/trunk/webapps/docs/changelog.xml	(revision 1795813)
+++ tc8.5.x/trunk/webapps/docs/changelog.xml	(revision 1795814)
@@ -57,6 +57,10 @@
         <code>o.a.c.connector.CoyoteAdapter#parseSessionCookiesId</code>.
         Patch provided by John Andrew (XUZHOUWANG) via Github. (violetagg)
       </fix>
+      <fix>
+        <bug>61101</bug>: CORS filter should set Vary header in response.
+        Submitted by Rick Riemer. (remm)
+      </fix>
     </changelog>
   </subsection>
   <subsection name="Coyote">
Index: tc8.5.x/trunk
===================================================================
--- tc8.5.x/trunk	(revision 1795813)
+++ tc8.5.x/trunk	(revision 1795814)

Property changes on: tc8.5.x/trunk
___________________________________________________________________
Modified: svn:mergeinfo
## -0,0 +0,1 ##
   Merged /tomcat/trunk:r1795813
