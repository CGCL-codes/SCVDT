diff --git a/xstream/src/java/com/thoughtworks/xstream/io/xml/Dom4JDriver.java b/xstream/src/java/com/thoughtworks/xstream/io/xml/Dom4JDriver.java
index bce7cff5..ea35a76e 100644
--- a/xstream/src/java/com/thoughtworks/xstream/io/xml/Dom4JDriver.java
+++ b/xstream/src/java/com/thoughtworks/xstream/io/xml/Dom4JDriver.java
@@ -1,6 +1,6 @@
 /*
  * Copyright (C) 2004, 2005, 2006 Joe Walnes.
- * Copyright (C) 2006, 2007, 2009, 2011 XStream Committers.
+ * Copyright (C) 2006, 2007, 2009, 2011, 2014, 2015 XStream Committers.
  * All rights reserved.
  *
  * The software in this package is published under the terms of the BSD
@@ -26,6 +26,7 @@
 import org.dom4j.io.OutputFormat;
 import org.dom4j.io.SAXReader;
 import org.dom4j.io.XMLWriter;
+import org.xml.sax.SAXException;
 
 import com.thoughtworks.xstream.io.HierarchicalStreamReader;
 import com.thoughtworks.xstream.io.HierarchicalStreamWriter;
@@ -89,8 +90,7 @@ public void setOutputFormat(OutputFormat outputFormat) {
 
     public HierarchicalStreamReader createReader(Reader text) {
         try {
-            SAXReader reader = new SAXReader();
-            Document document = reader.read(text);
+            final Document document = createReader().read(text);
             return new Dom4JReader(document, getNameCoder());
         } catch (DocumentException e) {
             throw new StreamException(e);
@@ -99,8 +99,7 @@ public HierarchicalStreamReader createReader(Reader text) {
 
     public HierarchicalStreamReader createReader(InputStream in) {
         try {
-            SAXReader reader = new SAXReader();
-            Document document = reader.read(in);
+            final Document document = createReader().read(in);
             return new Dom4JReader(document, getNameCoder());
         } catch (DocumentException e) {
             throw new StreamException(e);
@@ -112,8 +111,7 @@ public HierarchicalStreamReader createReader(InputStream in) {
      */
     public HierarchicalStreamReader createReader(URL in) {
         try {
-            SAXReader reader = new SAXReader();
-            Document document = reader.read(in);
+            final Document document = createReader().read(in);
             return new Dom4JReader(document, getNameCoder());
         } catch (DocumentException e) {
             throw new StreamException(e);
@@ -125,8 +123,7 @@ public HierarchicalStreamReader createReader(URL in) {
      */
     public HierarchicalStreamReader createReader(File in) {
         try {
-            SAXReader reader = new SAXReader();
-            Document document = reader.read(in);
+            final Document document = createReader().read(in);
             return new Dom4JReader(document, getNameCoder());
         } catch (DocumentException e) {
             throw new StreamException(e);
@@ -148,4 +145,21 @@ public HierarchicalStreamWriter createWriter(final OutputStream out) {
         final Writer writer = new OutputStreamWriter(out);
         return createWriter(writer);
     }
+
+    /**
+     * Create and initialize the SAX reader.
+     * 
+     * @return the SAX reader instance.
+     * @throws DocumentException if DOCTYPE processing cannot be disabled
+     * @since upcoming
+     */
+    protected SAXReader createReader() throws DocumentException {
+        final SAXReader reader = new SAXReader();
+        try {
+            reader.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true);
+        } catch (SAXException e) {
+            throw new DocumentException("Cannot disable DOCTYPE processing", e);
+        }
+        return reader;
+    }
 }
diff --git a/xstream/src/test/com/thoughtworks/xstream/io/xml/Dom4JReaderTest.java b/xstream/src/test/com/thoughtworks/xstream/io/xml/Dom4JReaderTest.java
index 08d90b5f..350af5a7 100644
--- a/xstream/src/test/com/thoughtworks/xstream/io/xml/Dom4JReaderTest.java
+++ b/xstream/src/test/com/thoughtworks/xstream/io/xml/Dom4JReaderTest.java
@@ -52,7 +52,7 @@ public void testIsXXEVulnerable() throws Exception {
             fail("Thrown " + XStreamException.class.getName() + " expected");
         } catch (final XStreamException e) {
             final String message = e.getMessage();
-            if (message.contains("Package")) {
+            if (!message.contains("DOCTYPE")) {
                 throw e;
             }
         }
