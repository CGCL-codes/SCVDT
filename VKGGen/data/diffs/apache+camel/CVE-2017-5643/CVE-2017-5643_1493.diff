From 2e8f21dec883b083ddcdddd802847b4c378a61a2 Mon Sep 17 00:00:00 2001
From: Tomohisa Igarashi <tm.igarashi@gmail.com>
Date: Sat, 25 Feb 2017 16:59:31 +0900
Subject: [PATCH] CAMEL-10894 Fixed test failure

---
 .../org/apache/camel/processor/validation/SchemaReader.java     | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/camel-core/src/main/java/org/apache/camel/processor/validation/SchemaReader.java b/camel-core/src/main/java/org/apache/camel/processor/validation/SchemaReader.java
index 354acd46a43..c5a37a3db4f 100644
--- a/camel-core/src/main/java/org/apache/camel/processor/validation/SchemaReader.java
+++ b/camel-core/src/main/java/org/apache/camel/processor/validation/SchemaReader.java
@@ -173,7 +173,7 @@ protected SchemaFactory createSchemaFactory() {
         if (getResourceResolver() != null) {
             factory.setResourceResolver(getResourceResolver());
         }  
-        if (!Boolean.parseBoolean(camelContext.getGlobalOptions().get(ACCESS_EXTERNAL_DTD))) {
+        if (camelContext != null && !Boolean.parseBoolean(camelContext.getGlobalOptions().get(ACCESS_EXTERNAL_DTD))) {
             try {
                 factory.setProperty(XMLConstants.ACCESS_EXTERNAL_DTD, "");
             } catch (SAXException e) {
