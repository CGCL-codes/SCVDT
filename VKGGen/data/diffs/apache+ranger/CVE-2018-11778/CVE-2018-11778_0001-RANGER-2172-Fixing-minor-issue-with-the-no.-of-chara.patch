From d1c1e54216f228e6400d17ec463dd14efe31e49e Mon Sep 17 00:00:00 2001
From: Sailaja Polavarapu <spolavarapu@hortonworks.com>
Date: Thu, 2 Aug 2018 12:33:24 -0700
Subject: [PATCH 1/1] RANGER-2172: Fixing minor issue with the no. of
 characters read using sscanf

---
 unixauthnative/src/main/c/credValidator.c | 2 +-
 unixauthpam/src/main/c/pamCredValidator.c | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/unixauthnative/src/main/c/credValidator.c b/unixauthnative/src/main/c/credValidator.c
index 189c2ca5e..e426bdd2f 100644
--- a/unixauthnative/src/main/c/credValidator.c
+++ b/unixauthnative/src/main/c/credValidator.c
@@ -35,7 +35,7 @@ int main(int ac, char **av, char **ev)
 	struct spwd *spwd ; 
 
 	fgets(line,512,stdin) ;
-	sprintf(format, "LOGIN:%%%ds %%%ds", STRLEN, STRLEN);
+	sprintf(format, "LOGIN:%%%ds %%%ds", STRLEN-1, STRLEN-1);
 	sscanf(line, format, username,password) ;
 
 	pwp = getpwnam(username) ;
diff --git a/unixauthpam/src/main/c/pamCredValidator.c b/unixauthpam/src/main/c/pamCredValidator.c
index 8e3690301..60d38aebd 100644
--- a/unixauthpam/src/main/c/pamCredValidator.c
+++ b/unixauthpam/src/main/c/pamCredValidator.c
@@ -66,7 +66,7 @@ int main(int ac, char **av, char **ev)
 	int retval;
 	pam_handle_t *pamh = NULL;
 
-	sprintf(format, "LOGIN:%%%ds %%%ds", STRLEN, STRLEN);
+	sprintf(format, "LOGIN:%%%ds %%%ds", STRLEN-1, STRLEN-1);
 	fgets(line,512,stdin) ;
 	sscanf(line, format, username,password) ;
 	conv.appdata_ptr = (char *) password;
-- 
2.14.3 (Apple Git-98)

