package com.hust.kg.repository.vulnerability;

import com.hust.kg.entity.vulnerability.VulnType;
import org.springframework.data.neo4j.repository.query.Query;
import org.springframework.data.repository.Repository;
import org.springframework.data.repository.query.Param;

import java.util.List;

/**
 * @Author wk
 * @Date 2021/03/25 17:37
 * @Description:
 */
public interface VulnTypeRepository extends Repository<VulnType, Long> {

    @Query("match (n:VulnType) return n")
    public List<VulnType> findAll();

    @Query("match (n:VulnType{cwe_id:$cwe_id}) return n")
    public VulnType findCWE(@Param("cwe_id")String cweID);

    @Query("match (n:VulnType) where n.cwe_id=~ ('.*'+$cwe_id+'.*') return n")
    public List<VulnType> fuzzyFindCWE(@Param("cwe_id")String cweID);
}
