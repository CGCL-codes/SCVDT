package com.hust.kg.repository.vulnerability;

import com.hust.kg.entity.vulnerability.Vulnerability;
import org.springframework.data.neo4j.repository.query.Query;
import org.springframework.data.repository.Repository;
import org.springframework.data.repository.query.Param;

import java.sql.ResultSet;
import java.util.List;

/**
 * @Author wk
 * @Date 2021/03/25 10:19
 * @Description:
 */

public interface VulnerabilityRepository extends Repository<Vulnerability, Long> {
//    @Query("match (n:Vulnerability{cve_id:'$cveID'}) return n")
//    List<Vulnerability> findResultsByCVE(@Param("cve_id")String cveID);

    @Query("match (n:Vulnerability) where id(n)=$id return n")
    Vulnerability findResultsByID(@Param("id")Long id);

    @Query("match (n:Vulnerability) where n.cve_id=$cve_id return n")
    List<Vulnerability> findResultsByCVE(@Param("cve_id")String cveID);

    @Query("match (n:Vulnerability) where n.cve_id=~ ('.*'+$cve_id+'.*') return n")
    List<Vulnerability> fuzzyFindCVE(@Param("cve_id")String cveID);

    @Query("match (n:Vulnerability) return n limit 200")
    List<Vulnerability> findAllCVEs();

//    @Query("match p=(n:Vulnerability)-[*]->() where n.cve_id=$cve_id return p")
//    List<Vulnerability> findAllRelations(@Param("cve_id")String cveID);
}
