package com.hust.kg.entity.vulnerability;

import org.springframework.data.neo4j.core.schema.*;

import java.util.List;

/**
 * @Author wk
 * @Date 2021/03/24 16:56
 * @Description:
 */
@Node("Vulnerability")
public class Vulnerability {
    @Id
    @GeneratedValue
    private Long id;

    @Property(name="cve_id")
    private String cveID;

    private String description;

    @Property(name="published_time")
    private String publishedTime;

    private String author;

    private String link;

    @Relationship(type = "has")
    private VulnType vulnType;

    @Relationship(type = "has")
    private CVSS cvss;

    @Relationship(type = "has")
    private List<Exploit> exploits;

    @Relationship(type = "affect")
    private List<SoftwareVersion> softwareVersions;

    @Relationship(type = "has")
    private List<VulnPatch> patches;

    public Vulnerability(Long id, String cveID, String description, String publishedTime, String author, String link) {
        this.id = id;
        this.cveID = cveID;
        this.description = description;
        this.publishedTime = publishedTime;
        this.author = author;
        this.link = link;
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getCveID() {
        return cveID;
    }

    public void setCveID(String cveID) {
        this.cveID = cveID;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public String getPublishedTime() {
        return publishedTime;
    }

    public void setPublishedTime(String publishedTime) {
        this.publishedTime = publishedTime;
    }

    public String getAuthor() {
        return author;
    }

    public void setAuthor(String author) {
        this.author = author;
    }

    public String getLink() {
        return link;
    }

    public void setLink(String link) {
        this.link = link;
    }

    public VulnType getVulnType() {
        return vulnType;
    }

    public void setVulnType(VulnType vulnType) {
        this.vulnType = vulnType;
    }

    public CVSS getCvss() {
        return cvss;
    }

    public void setCvss(CVSS cvss) {
        this.cvss = cvss;
    }

    public List<Exploit> getExploits() {
        return exploits;
    }

    public void setExploits(List<Exploit> exploits) {
        this.exploits = exploits;
    }

    public List<SoftwareVersion> getSoftwareVersions() {
        return softwareVersions;
    }

    public void setSoftwareVersions(List<SoftwareVersion> softwareVersions) {
        this.softwareVersions = softwareVersions;
    }

    public List<VulnPatch> getPatches() {
        return patches;
    }

    public void setPatches(List<VulnPatch> patches) {
        this.patches = patches;
    }

    @Override
    public String toString() {
        return "Vulnerability{" +
                "id=" + id +
                ", cveID='" + cveID + '\'' +
                ", description='" + description + '\'' +
                ", publishedTime='" + publishedTime + '\'' +
                ", author='" + author + '\'' +
                ", link='" + link + '\'' +
                ", vulnType=" + vulnType +
                ", cvss=" + cvss +
                ", exploits=" + exploits +
                ", softwareVersions=" + softwareVersions +
                ", patches=" + patches +
                '}';
    }
}
