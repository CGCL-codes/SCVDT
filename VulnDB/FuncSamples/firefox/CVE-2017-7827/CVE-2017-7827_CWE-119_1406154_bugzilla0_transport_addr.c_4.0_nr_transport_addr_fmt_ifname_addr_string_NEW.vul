int nr_transport_addr_fmt_ifname_addr_string(const nr_transport_addr *addr, char *buf, int len)
  {
    int _status;
    /* leave room for a fully-expanded IPV4-mapped IPV6 address */
    char buffer[46];

    switch(addr->ip_version){
      case NR_IPV4:
        if (!inet_ntop(AF_INET, &addr->u.addr4.sin_addr,buffer,sizeof(buffer))) {
           strncpy(buffer, "[error]", len);
        }
        break;
      case NR_IPV6:
        if (!inet_ntop(AF_INET6, &addr->u.addr6.sin6_addr,buffer,sizeof(buffer))) {
           strncpy(buffer, "[error]", len);
        }
        break;
      default:
        ABORT(R_INTERNAL);
    }
    buffer[sizeof(buffer) - 1] = '\0';

    snprintf(buf,len,"%s:%s",addr->ifname,buffer);
    buf[len - 1] = '\0';

    _status=0;
  abort:
    return(_status);
  }
