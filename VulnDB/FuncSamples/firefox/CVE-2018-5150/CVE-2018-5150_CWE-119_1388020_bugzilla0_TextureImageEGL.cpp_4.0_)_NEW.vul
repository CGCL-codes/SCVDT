bool
TextureImageEGL::DirectUpdate(gfx::DataSourceSurface* aSurf, const nsIntRegion& aRegion, const gfx::IntPoint& aFrom /* = gfx::IntPoint(0,0) */)
{
    gfx::IntRect bounds = aRegion.GetBounds();

    nsIntRegion region;
    if (mTextureState != Valid) {
        bounds = gfx::IntRect(0, 0, mSize.width, mSize.height);
        region = nsIntRegion(bounds);
    } else {
        region = aRegion;
    }

    bool needInit = mTextureState == Created;
    size_t uploadSize = 0;
    mTextureFormat =
      UploadSurfaceToTexture(mGLContext,
                             aSurf,
                             region,
                             mTexture,
                             mSize,
                             &uploadSize,
                             needInit,
                             aFrom);
    if (mTextureFormat == SurfaceFormat::UNKNOWN) {
        return false;
    }

    if (uploadSize > 0) {
        UpdateUploadSize(uploadSize);
    }

    mTextureState = Valid;
    return true;
}
