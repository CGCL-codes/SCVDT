static bool GetStringValue(HKEY hRegKey, LPCTSTR valueName, wstring& value)
{
  DWORD type, dataSize;
  wchar_t buf[2048] = {};
  dataSize = sizeof(buf) - 1;
  if (RegQueryValueEx(hRegKey, valueName, nullptr,
                     &type, (LPBYTE)buf, &dataSize) == ERROR_SUCCESS &&
      type == REG_SZ) {
    value = buf;
    return true;
  }

  return false;
}
