static SECStatus
serial_read_mp_int(msgpack_unpacker* upk, mp_int* n, const mp_int* max)
{
  SECStatus rv = SECSuccess;
  P_CHECKCB(upk != NULL);
  P_CHECKCB(n != NULL);
  P_CHECKCB(max != NULL);

  msgpack_unpacked res;
  msgpack_unpacked_init(&res);
  UP_CHECK(msgpack_unpacker_next(upk, &res))

  msgpack_object obj = res.data;
  P_CHECKC(object_to_mp_int(&obj, n, max));

cleanup:
  msgpack_unpacked_destroy(&res);

  return rv;
}
