  void
  DispatchToIOThread()
  {
    AssertIsOnOwningThread();

    if (NS_WARN_IF(Client::IsShuttingDownOnBackgroundThread()) ||
        IsActorDestroyed()) {
      Fail();
      return;
    }

    QuotaManager* qm = QuotaManager::Get();
    MOZ_ASSERT(qm);

    nsresult rv = qm->IOThread()->Dispatch(this, NS_DISPATCH_NORMAL);
    if (NS_FAILED(rv)) {
      Fail();
      return;
    }
  }
