static int
load_seg(
    enum x86_segment seg,
    uint16_t sel, bool_t is_ret,
    struct x86_emulate_ctxt *ctxt,
    const struct x86_emulate_ops *ops)
{
    if ( (ops->read_segment == NULL) ||
         (ops->write_segment == NULL) )
        return X86EMUL_UNHANDLEABLE;

    if ( in_protmode(ctxt, ops) )
        return protmode_load_seg(seg, sel, is_ret, ctxt, ops);

    return realmode_load_seg(seg, sel, ctxt, ops);
}
