void _read_unlock(rwlock_t *lock)
{
    uint32_t x, y;

    preempt_enable();
    x = lock->lock;
    while ( (y = cmpxchg(&lock->lock, x, x-1)) != x )
        x = y;
}
