void destroy_irq(unsigned int irq)
{
    BUG_ON(!MSI_IRQ(irq));

    if ( dom0 )
    {
        int err = irq_deny_access(dom0, irq);

        if ( err )
            printk(XENLOG_G_ERR
                   "Could not revoke Dom0 access to IRQ%u (error %d)\n",
                   irq, err);
    }

    dynamic_irq_cleanup(irq);
    clear_irq_vector(irq);
}
