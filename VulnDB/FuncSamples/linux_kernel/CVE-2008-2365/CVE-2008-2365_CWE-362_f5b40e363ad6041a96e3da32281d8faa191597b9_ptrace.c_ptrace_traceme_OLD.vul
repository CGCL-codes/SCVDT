int ptrace_traceme(void)
{
	int ret;

	/*
	 * Are we already being traced?
	 */
	if (current->ptrace & PT_PTRACED)
		return -EPERM;
	ret = security_ptrace(current->parent, current);
	if (ret)
		return -EPERM;
	/*
	 * Set the ptrace bit in the process ptrace flags.
	 */
	current->ptrace |= PT_PTRACED;
	return 0;
}
