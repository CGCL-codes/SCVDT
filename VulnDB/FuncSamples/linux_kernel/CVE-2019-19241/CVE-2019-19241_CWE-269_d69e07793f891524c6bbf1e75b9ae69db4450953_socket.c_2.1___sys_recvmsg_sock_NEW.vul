long __sys_recvmsg_sock(struct socket *sock, struct user_msghdr __user *umsg,
			unsigned int flags)
{
	struct iovec iovstack[UIO_FASTIOV], *iov = iovstack;
	struct sockaddr_storage address;
	struct msghdr msg = { .msg_name = &address };
	struct sockaddr __user *uaddr;
	ssize_t err;

	err = recvmsg_copy_msghdr(&msg, umsg, flags, &uaddr, &iov);
	if (err)
		return err;
	/* disallow ancillary data requests from this path */
	if (msg.msg_control || msg.msg_controllen) {
		err = -EINVAL;
		goto out;
	}

	err = ____sys_recvmsg(sock, &msg, umsg, uaddr, flags, 0);
out:
	kfree(iov);
	return err;
}
