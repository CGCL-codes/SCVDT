int bdrv_write_compressed(BlockDriverState *bs, int64_t sector_num,
                          const uint8_t *buf, int nb_sectors)
{
    BlockDriver *drv = bs->drv;
    if (!drv)
        return -ENOMEDIUM;
    if (!drv->bdrv_write_compressed)
        return -ENOTSUP;
    if (bdrv_wr_badreq_sectors(bs, sector_num, nb_sectors))
        return -EDOM;
    return drv->bdrv_write_compressed(bs, sector_num, buf, nb_sectors);
}
