static void destroy_session(struct skinnysession *s)
{
	ast_mutex_lock(&s->lock);
	if (s->fd > -1) {
		close(s->fd);
	}

	if (s->device) {
		s->device->session = NULL;
	} else {
		ast_atomic_fetchadd_int(&unauth_sessions, -1);
	}
	ast_mutex_unlock(&s->lock);
	ast_mutex_destroy(&s->lock);

	if (s->t != AST_PTHREADT_NULL) {
		pthread_detach(s->t);
	}

	ast_free(s);
}
