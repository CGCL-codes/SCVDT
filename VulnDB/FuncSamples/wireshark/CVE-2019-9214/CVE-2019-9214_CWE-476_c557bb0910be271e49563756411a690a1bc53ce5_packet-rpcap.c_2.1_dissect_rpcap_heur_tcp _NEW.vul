static gboolean
dissect_rpcap_heur_tcp (tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data)
{
  if (check_rpcap_heur (tvb, TRUE)) {
    /*
     * This is probably a rpcap TCP packet.
     * Make the dissector for this conversation the non-heuristic
     * rpcap dissector, so that malformed rpcap packets are reported
     * as such.
     */
    conversation_t *conversation = find_or_create_conversation (pinfo);
    if (conversation)
      conversation_set_dissector_from_frame_number (conversation,
                                                  pinfo->num,
                                                  rpcap_tcp_handle);
    tcp_dissect_pdus (tvb, pinfo, tree, rpcap_desegment, 8,
                      get_rpcap_pdu_len, dissect_rpcap, data);

    return TRUE;
  }

  return FALSE;
}
