static guint
get_value_length(tvbuff_t *tvb, guint offset, guint *byte_count, packet_info *pinfo)
{
    guint        field;

    field = tvb_get_guint8(tvb, offset++);
    if (field < 31)
        *byte_count = 1;
    else {                      /* Must be 31 so, Uintvar follows       */
        field = tvb_get_guintvar(tvb, offset, byte_count, pinfo, &ei_mmse_oversized_uintvar);
        (*byte_count)++;
    }

    /* The packet says there are this many bytes; ensure they're there.
     * We do this here because several callers do math on the length we
     * return here and may not catch an overflow.
     */
    tvb_ensure_bytes_exist(tvb, offset, field);
    return field;
}
