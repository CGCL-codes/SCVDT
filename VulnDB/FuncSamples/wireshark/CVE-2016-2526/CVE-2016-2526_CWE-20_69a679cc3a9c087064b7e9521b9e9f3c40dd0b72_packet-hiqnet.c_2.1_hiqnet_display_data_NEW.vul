static gint
hiqnet_display_data(proto_tree *hiqnet_payload_tree, packet_info *pinfo, tvbuff_t *tvb, gint offset) {
    guint8 datatype = 0;
    gint datalen = 0;
    proto_item* ti;

    datatype = tvb_get_guint8(tvb, offset);
    ti = proto_tree_add_item(hiqnet_payload_tree, hf_hiqnet_datatype, tvb, offset, 1, ENC_BIG_ENDIAN);
    offset += 1;
    if (datatype < sizeof(hiqnet_datasize_per_type)/sizeof(int))
        datalen = hiqnet_datasize_per_type[datatype];
    else
        expert_add_info(pinfo, ti, &ei_hiqnet_datatype);
    if (datalen < 0) { /* This is a string or a block */
        datalen = tvb_get_ntohs(tvb, offset);
        proto_tree_add_item(hiqnet_payload_tree, hf_hiqnet_datalen, tvb, offset, 2, ENC_BIG_ENDIAN);
        offset += 2;
    }
    if (datatype == 9) { /* This is a string */
        proto_tree_add_item(hiqnet_payload_tree, hf_hiqnet_string, tvb, offset, datalen, ENC_UCS_2);
    } else {
        proto_tree_add_item(hiqnet_payload_tree, hf_hiqnet_value, tvb, offset, datalen, ENC_NA);
    }
    offset += datalen;
    return offset;
}
