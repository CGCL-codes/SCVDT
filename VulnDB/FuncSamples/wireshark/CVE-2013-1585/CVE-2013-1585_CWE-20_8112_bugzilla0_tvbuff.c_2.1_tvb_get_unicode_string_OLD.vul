gchar *
tvb_get_unicode_string(tvbuff_t *tvb, const gint offset, gint length, const guint encoding)
{
	gunichar2  uchar;
	gint       i;           /* Byte counter for tvbuff */
	GString   *strbuf = NULL;

	strbuf = g_string_new(NULL);

	for(i = 0; i < length; i += 2) {

		if (encoding == ENC_BIG_ENDIAN)
			uchar = tvb_get_ntohs(tvb, offset + i);
		else
			uchar = tvb_get_letohs(tvb, offset + i);

		g_string_append_unichar(strbuf, uchar);
	}

	return g_string_free(strbuf, FALSE);
}
