static int extract_min_max(IPAddressOrRange *aor,
			    unsigned char *min,
			    unsigned char *max,
			    int length)
{
  if (aor == NULL || min == NULL || max == NULL)
    return 0;
  switch (aor->type) {
  case IPAddressOrRange_addressPrefix:
    return (addr_expand(min, aor->u.addressPrefix, length, 0x00) &&
	    addr_expand(max, aor->u.addressPrefix, length, 0xFF));
  case IPAddressOrRange_addressRange:
    return (addr_expand(min, aor->u.addressRange->min, length, 0x00) &&
	    addr_expand(max, aor->u.addressRange->max, length, 0xFF));
  }
  return 0;
}
