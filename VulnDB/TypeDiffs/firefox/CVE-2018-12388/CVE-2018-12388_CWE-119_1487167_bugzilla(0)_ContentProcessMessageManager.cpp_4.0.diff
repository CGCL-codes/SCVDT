diff -r b1b3f1e5ec42 -r 3e4a2d14ca35 dom/base/ContentProcessMessageManager.cpp
--- a/dom/base/ContentProcessMessageManager.cpp	Fri Oct 05 11:38:00 2018 -0400
+++ b/dom/base/ContentProcessMessageManager.cpp	Tue Aug 28 21:26:50 2018 -0700
@@ -114,13 +114,17 @@
 JSObject*
 ContentProcessMessageManager::GetOrCreateWrapper()
 {
-  AutoJSAPI jsapi;
-  jsapi.Init();
+  JS::RootedValue val(RootingCx());
+  {
+    // Scope to run ~AutoJSAPI before working with a raw JSObject*.
+    AutoJSAPI jsapi;
+    jsapi.Init();
 
-  JS::RootedValue val(jsapi.cx());
-  if (!GetOrCreateDOMReflectorNoWrap(jsapi.cx(), this, &val)) {
-    return nullptr;
+    if (!GetOrCreateDOMReflectorNoWrap(jsapi.cx(), this, &val)) {
+      return nullptr;
+    }
   }
+  MOZ_ASSERT(val.isObject());
   return &val.toObject();
 }
 
