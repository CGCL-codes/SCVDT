diff -r 2329af476fa6 -r 82bc09e9f191 layout/printing/nsPrintData.cpp
--- a/layout/printing/nsPrintData.cpp	Fri Apr 28 16:25:01 2017 +0900
+++ b/layout/printing/nsPrintData.cpp	Tue May 02 17:07:45 2017 +0900
@@ -108,11 +108,17 @@
                                 bool         aDoStartStop,
                                 int32_t      aFlag)
 {
-  for (int32_t i=0;i<mPrintProgressListeners.Count();i++) {
-    nsIWebProgressListener* wpl = mPrintProgressListeners.ObjectAt(i);
-    wpl->OnProgressChange(nullptr, nullptr, aProgress, aMaxProgress, aProgress, aMaxProgress);
+  size_t numberOfListeners = mPrintProgressListeners.Length();
+  for (size_t i = 0; i < numberOfListeners; ++i) {
+    nsCOMPtr<nsIWebProgressListener> listener =
+      mPrintProgressListeners.SafeElementAt(i);
+    if (NS_WARN_IF(!listener)) {
+      continue;
+    }
+    listener->OnProgressChange(nullptr, nullptr, aProgress, aMaxProgress,
+                               aProgress, aMaxProgress);
     if (aDoStartStop) {
-      wpl->OnStateChange(nullptr, nullptr, aFlag, NS_OK);
+      listener->OnStateChange(nullptr, nullptr, aFlag, NS_OK);
     }
   }
 }
@@ -120,12 +126,14 @@
 void
 nsPrintData::DoOnStatusChange(nsresult aStatus)
 {
-  uint32_t numberOfListeners = mPrintProgressListeners.Length();
-  for (uint32_t i = 0; i < numberOfListeners; ++i) {
-    nsIWebProgressListener* listener = mPrintProgressListeners.SafeElementAt(i);
-    if (listener) {
-      listener->OnStatusChange(nullptr, nullptr, aStatus, nullptr);
+  size_t numberOfListeners = mPrintProgressListeners.Length();
+  for (size_t i = 0; i < numberOfListeners; ++i) {
+    nsCOMPtr<nsIWebProgressListener> listener =
+      mPrintProgressListeners.SafeElementAt(i);
+    if (NS_WARN_IF(!listener)) {
+      continue;
     }
+    listener->OnStatusChange(nullptr, nullptr, aStatus, nullptr);
   }
 }
 
