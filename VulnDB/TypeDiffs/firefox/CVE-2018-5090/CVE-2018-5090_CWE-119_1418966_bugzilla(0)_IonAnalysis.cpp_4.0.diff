diff -r 935393b713cb -r 32bb2e9efd34 js/src/jit/IonAnalysis.cpp
--- a/js/src/jit/IonAnalysis.cpp	Mon Dec 18 14:42:21 2017 +0200
+++ b/js/src/jit/IonAnalysis.cpp	Wed Dec 13 14:13:43 2017 -0600
@@ -4430,7 +4430,8 @@
     if (script->length() > MAX_SCRIPT_SIZE)
         return true;
 
-    if (!script->ensureHasTypes(cx))
+    AutoKeepTypeScripts keepTypes(cx);
+    if (!script->ensureHasTypes(cx, keepTypes))
         return false;
 
     TraceLoggerThread* logger = TraceLoggerForCurrentThread(cx);
