diff -r 935393b713cb -r 32bb2e9efd34 js/src/jit/BaselineCompiler.cpp
--- a/js/src/jit/BaselineCompiler.cpp	Mon Dec 18 14:42:21 2017 +0200
+++ b/js/src/jit/BaselineCompiler.cpp	Wed Dec 13 14:13:43 2017 -0600
@@ -36,6 +36,7 @@
 #include "jit/MacroAssembler-inl.h"
 #include "vm/Interpreter-inl.h"
 #include "vm/NativeObject-inl.h"
+#include "vm/TypeInference-inl.h"
 
 using namespace js;
 using namespace js::jit;
@@ -98,7 +99,8 @@
     AutoTraceLog logScript(logger, scriptEvent);
     AutoTraceLog logCompile(logger, TraceLogger_BaselineCompilation);
 
-    if (!script->ensureHasTypes(cx) || !script->ensureHasAnalyzedArgsUsage(cx))
+    AutoKeepTypeScripts keepTypes(cx);
+    if (!script->ensureHasTypes(cx, keepTypes) || !script->ensureHasAnalyzedArgsUsage(cx))
         return Method_Error;
 
     // When code coverage is only enabled for optimizations, or when a Debugger
