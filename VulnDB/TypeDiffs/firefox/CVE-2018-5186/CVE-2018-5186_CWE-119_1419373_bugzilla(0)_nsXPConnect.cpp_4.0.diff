diff -r dcfb7f0bb6a9 -r d1c67d1afe26 js/xpconnect/src/nsXPConnect.cpp
--- a/js/xpconnect/src/nsXPConnect.cpp	Fri Apr 20 16:41:07 2018 +0900
+++ b/js/xpconnect/src/nsXPConnect.cpp	Mon Apr 23 10:51:33 2018 +0100
@@ -96,6 +96,7 @@
 
     mShuttingDown = true;
     XPCWrappedNativeScope::SystemIsBeingShutDown();
+    mRuntime->SystemIsBeingShutDown();
 
     // The above causes us to clean up a bunch of XPConnect data structures,
     // after which point we need to GC to clean everything up. We need to do
