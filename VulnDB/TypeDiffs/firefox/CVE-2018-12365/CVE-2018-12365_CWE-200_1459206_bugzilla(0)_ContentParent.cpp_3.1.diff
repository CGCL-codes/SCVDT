diff -r ea7f34ae33bb -r a3ebab26f0d9 dom/ipc/ContentParent.cpp
--- a/dom/ipc/ContentParent.cpp	Thu May 10 10:09:31 2018 +0100
+++ b/dom/ipc/ContentParent.cpp	Thu May 10 11:24:25 2018 +0200
@@ -5249,6 +5249,14 @@
 {
   MOZ_ASSERT(!mGetFilesPendingRequests.GetWeak(aUUID));
 
+  if (!mozilla::Preferences::GetBool("dom.filesystem.pathcheck.disabled", false)) {
+    RefPtr<FileSystemSecurity> fss = FileSystemSecurity::Get();
+    if (NS_WARN_IF(!fss ||
+                   !fss->ContentProcessHasAccessTo(ChildID(), aDirectoryPath))) {
+      return IPC_FAIL_NO_REASON(this);
+    }
+  }
+
   ErrorResult rv;
   RefPtr<GetFilesHelper> helper =
     GetFilesHelperParent::Create(aUUID, aDirectoryPath, aRecursiveFlag, this,
