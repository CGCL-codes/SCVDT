diff -r 5e594ff11d9e -r 3e903717a513 dom/ipc/TabParent.cpp
--- a/dom/ipc/TabParent.cpp	Mon Jan 28 22:12:00 2019 +0000
+++ b/dom/ipc/TabParent.cpp	Mon Jan 28 21:42:15 2019 +0000
@@ -1652,6 +1652,10 @@
 
   nsCOMPtr<imgIContainer> cursorImage;
   if (aHasCustomCursor) {
+    if (aHeight * aStride != aCursorData.Length() ||
+        aStride < aWidth * gfx::BytesPerPixel(aFormat)) {
+      return IPC_FAIL(this, "Invalid custom cursor data");
+    }
     const gfx::IntSize size(aWidth, aHeight);
     RefPtr<gfx::DataSourceSurface> customCursor =
         gfx::CreateDataSourceSurfaceFromData(
