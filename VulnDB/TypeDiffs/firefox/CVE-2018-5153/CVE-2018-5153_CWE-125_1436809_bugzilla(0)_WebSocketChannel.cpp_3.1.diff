diff -r d8c0fba8b94a -r 8cf59abf9839 netwerk/protocol/websocket/WebSocketChannel.cpp
--- a/netwerk/protocol/websocket/WebSocketChannel.cpp	Mon Mar 26 23:48:35 2018 -0500
+++ b/netwerk/protocol/websocket/WebSocketChannel.cpp	Mon Apr 02 12:59:18 2018 -0400
@@ -1052,6 +1052,9 @@
     nsresult rv = NS_ReadInputStreamToString(mMsg.pStream, *temp, mLength);
 
     NS_ENSURE_SUCCESS(rv, rv);
+    if (temp->Length() != mLength) {
+      return NS_ERROR_UNEXPECTED;
+    }
 
     mMsg.pStream->Close();
     mMsg.pStream->Release();
