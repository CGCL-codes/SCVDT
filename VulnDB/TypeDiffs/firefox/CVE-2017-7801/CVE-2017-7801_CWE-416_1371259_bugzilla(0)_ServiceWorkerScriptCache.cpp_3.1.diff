diff -r d44b343011f7 -r e3d205dc31f3 dom/workers/ServiceWorkerScriptCache.cpp
--- a/dom/workers/ServiceWorkerScriptCache.cpp	Tue Jul 11 05:55:27 2017 -0700
+++ b/dom/workers/ServiceWorkerScriptCache.cpp	Mon Jul 10 18:06:18 2017 -0400
@@ -396,15 +396,13 @@
         return;
       }
 
-      Cache* cache = nullptr;
+      RefPtr<Cache> cache;
       nsresult rv = UNWRAP_OBJECT(Cache, obj, cache);
       if (NS_WARN_IF(NS_FAILED(rv))) {
         Fail(rv);
         return;
       }
 
-      // Just to be safe.
-      RefPtr<Cache> kungfuDeathGrip = cache;
       WriteToCache(cache);
       return;
     }
@@ -919,13 +917,9 @@
   }
 
   JS::Rooted<JSObject*> obj(aCx, &aValue.toObject());
-  if (NS_WARN_IF(!obj)) {
-    mManager->CacheFinished(NS_ERROR_FAILURE, false);
-    return;
-  }
 
   Cache* cache = nullptr;
-  nsresult rv = UNWRAP_OBJECT(Cache, obj, cache);
+  nsresult rv = UNWRAP_OBJECT(Cache, &obj, cache);
   if (NS_WARN_IF(NS_FAILED(rv))) {
     mManager->CacheFinished(rv, false);
     return;
@@ -959,13 +953,9 @@
   MOZ_ASSERT(aValue.isObject());
 
   JS::Rooted<JSObject*> obj(aCx, &aValue.toObject());
-  if (NS_WARN_IF(!obj)) {
-    mManager->CacheFinished(NS_ERROR_FAILURE, false);
-    return;
-  }
 
   Response* response = nullptr;
-  nsresult rv = UNWRAP_OBJECT(Response, obj, response);
+  nsresult rv = UNWRAP_OBJECT(Response, &obj, response);
   if (NS_WARN_IF(NS_FAILED(rv))) {
     mManager->CacheFinished(rv, false);
     return;
