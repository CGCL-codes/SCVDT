diff -r 4ab3d69a2cf0 -r c4cbc063a8e7 dom/security/nsCSPUtils.cpp
--- a/dom/security/nsCSPUtils.cpp	Tue Jun 06 14:11:41 2017 +0800
+++ b/dom/security/nsCSPUtils.cpp	Tue Jun 06 09:12:13 2017 +0200
@@ -522,6 +522,7 @@
 nsCSPHostSrc::nsCSPHostSrc(const nsAString& aHost)
   : mHost(aHost)
   , mGeneratedFromSelfKeyword(false)
+  , mWithinFrameAncstorsDir(false)
 {
   ToLowerCase(mHost);
 }
@@ -705,6 +706,11 @@
     rv = url->GetFilePath(uriPath);
     NS_ENSURE_SUCCESS(rv, false);
 
+    if (mWithinFrameAncstorsDir) {
+      // no path matching for frame-ancestors to not leak any path information.
+      return true;
+    }
+
     nsString decodedUriPath;
     CSP_PercentDecodeStr(NS_ConvertUTF8toUTF16(uriPath), decodedUriPath);
 
