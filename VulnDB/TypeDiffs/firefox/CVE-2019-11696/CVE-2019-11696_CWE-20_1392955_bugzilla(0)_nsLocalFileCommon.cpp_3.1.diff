diff -r 8ffa5f870efb -r 45b70e8a557b xpcom/io/nsLocalFileCommon.cpp
--- a/xpcom/io/nsLocalFileCommon.cpp	Sat Mar 02 02:25:07 2019 +0200
+++ b/xpcom/io/nsLocalFileCommon.cpp	Sat Mar 02 00:01:26 2019 +0000
@@ -16,11 +16,112 @@
 #include "nsNativeCharsetUtils.h"
 #include "nsUTF8Utils.h"
 #include "nsArray.h"
+#include "nsLocalFileCommon.h"
 
 #ifdef XP_WIN
 #  include <string.h>
 #endif
 
+// Extensions that should be considered 'executable', ie will not allow users
+// to open immediately without first saving to disk, and potentially provoke
+// other warnings. PLEASE read the longer comment in
+// toolkit/components/reputationservice/ApplicationReputation.h
+// before modifying this list!
+/* static */
+const char* const sExecutableExts[] = {
+    // clang-format off
+  ".ad",
+  ".ade",         // access project extension
+  ".adp",
+  ".air",         // Adobe AIR installer
+  ".app",         // executable application
+  ".application", // from bug 348763
+  ".asp",
+  ".bas",
+  ".bat",
+  ".chm",
+  ".cmd",
+  ".com",
+  ".cpl",
+  ".crt",
+  ".exe",
+  ".fxp",         // FoxPro compiled app
+  ".hlp",
+  ".hta",
+  ".inf",
+  ".ins",
+  ".isp",
+  ".jar",         // java application bundle
+  ".jnlp",
+  ".js",
+  ".jse",
+  ".lnk",
+  ".mad",         // Access Module Shortcut
+  ".maf",         // Access
+  ".mag",         // Access Diagram Shortcut
+  ".mam",         // Access Macro Shortcut
+  ".maq",         // Access Query Shortcut
+  ".mar",         // Access Report Shortcut
+  ".mas",         // Access Stored Procedure
+  ".mat",         // Access Table Shortcut
+  ".mau",         // Media Attachment Unit
+  ".mav",         // Access View Shortcut
+  ".maw",         // Access Data Access Page
+  ".mda",         // Access Add-in, MDA Access 2 Workgroup
+  ".mdb",
+  ".mde",
+  ".mdt",         // Access Add-in Data
+  ".mdw",         // Access Workgroup Information
+  ".mdz",         // Access Wizard Template
+  ".msc",
+  ".msh",         // Microsoft Shell
+  ".msh1",        // Microsoft Shell
+  ".msh1xml",     // Microsoft Shell
+  ".msh2",        // Microsoft Shell
+  ".msh2xml",     // Microsoft Shell
+  ".mshxml",      // Microsoft Shell
+  ".msi",
+  ".msp",
+  ".mst",
+  ".ops",         // Office Profile Settings
+  ".pcd",
+  ".pif",
+  ".plg",         // Developer Studio Build Log
+  ".prf",         // windows system file
+  ".prg",
+  ".pst",
+  ".reg",
+  ".scf",         // Windows explorer command
+  ".scr",
+  ".sct",
+  ".settingcontent-ms",
+  ".shb",
+  ".shs",
+  ".url",
+  ".vb",
+  ".vbe",
+  ".vbs",
+  ".vdx",
+  ".vsd",
+  ".vsdm",
+  ".vsdx",
+  ".vsmacros",    // Visual Studio .NET Binary-based Macro Project
+  ".vss",
+  ".vssm",
+  ".vssx",
+  ".vst",
+  ".vstm",
+  ".vstx",
+  ".vsw",
+  ".vsx",
+  ".vtx",
+  ".ws",
+  ".wsc",
+  ".wsf",
+  ".wsh"
+    // clang-format on
+};
+
 #if !defined(MOZ_WIDGET_COCOA) && !defined(XP_WIN)
 NS_IMETHODIMP
 nsLocalFile::InitWithFile(nsIFile* aFile) {
