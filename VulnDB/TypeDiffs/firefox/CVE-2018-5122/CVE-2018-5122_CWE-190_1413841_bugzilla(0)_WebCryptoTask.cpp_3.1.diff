diff -r 87b9a23fc0cf -r 9db3839609e0 dom/crypto/WebCryptoTask.cpp
--- a/dom/crypto/WebCryptoTask.cpp	Sat Dec 02 08:20:59 2017 -0800
+++ b/dom/crypto/WebCryptoTask.cpp	Tue Nov 28 10:00:47 2017 +0100
@@ -716,12 +716,16 @@
       return NS_ERROR_DOM_INVALID_ACCESS_ERR;
     }
 
+    // Check whether the integer addition would overflow.
+    if (std::numeric_limits<CryptoBuffer::size_type>::max() - 16 < mData.Length()) {
+      return NS_ERROR_DOM_DATA_ERR;
+    }
+
     // Initialize the output buffer (enough space for padding / a full tag)
-    uint32_t dataLen = mData.Length();
-    uint32_t maxLen = dataLen + 16;
-    if (!mResult.SetLength(maxLen, fallible)) {
+    if (!mResult.SetLength(mData.Length() + 16, fallible)) {
       return NS_ERROR_DOM_UNKNOWN_ERR;
     }
+
     uint32_t outLen = 0;
 
     // Perform the encryption/decryption
