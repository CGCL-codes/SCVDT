diff -r 9253a827f52d -r 98bac674e9bc widget/windows/nsWindowGfx.cpp
--- a/widget/windows/nsWindowGfx.cpp	Thu Jun 21 14:57:12 2018 -0700
+++ b/widget/windows/nsWindowGfx.cpp	Thu Jun 21 22:17:48 2018 +0200
@@ -325,6 +325,8 @@
 #if defined(MOZ_XUL)
           // don't support transparency for non-GDI rendering, for now
           if (eTransparencyTransparent == mTransparencyMode) {
+            // This mutex needs to be held when EnsureTransparentSurface is called.
+            MutexAutoLock lock(mBasicLayersSurface->GetTransparentSurfaceLock());
             targetSurface = mBasicLayersSurface->EnsureTransparentSurface();
           }
 #endif
