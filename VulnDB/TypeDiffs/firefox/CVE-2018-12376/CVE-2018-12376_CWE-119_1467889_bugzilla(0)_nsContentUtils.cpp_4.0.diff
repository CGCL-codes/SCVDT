diff -r 4a79d4e9efff -r f7b6f9fd2de5 dom/base/nsContentUtils.cpp
--- a/dom/base/nsContentUtils.cpp	Thu Jun 28 14:33:32 2018 -0500
+++ b/dom/base/nsContentUtils.cpp	Mon Aug 06 19:01:21 2018 +0300
@@ -7823,8 +7823,8 @@
 
         // The buffer contains the terminating null.
         Shmem itemData = item.data().get_Shmem();
-        const nsDependentCString text(itemData.get<char>(),
-                                      itemData.Size<char>());
+        const nsDependentCSubstring text(itemData.get<char>(),
+                                         itemData.Size<char>());
         rv = dataWrapper->SetData(text);
         NS_ENSURE_SUCCESS(rv, rv);
 
@@ -8005,7 +8005,7 @@
            : static_cast<IShmemAllocator*>(aParent);
 
   Shmem result;
-  if (!allocator->AllocShmem(aInput.Length() + 1,
+  if (!allocator->AllocShmem(aInput.Length(),
                              SharedMemory::TYPE_BASIC,
                              &result)) {
     return result;
@@ -8013,7 +8013,7 @@
 
   memcpy(result.get<char>(),
          aInput.BeginReading(),
-         aInput.Length() + 1);
+         aInput.Length());
 
   return result;
 }
