diff -r 7e502b527f07 -r 5a428c9953ab dom/xbl/nsXBLBinding.cpp
--- a/dom/xbl/nsXBLBinding.cpp	Sat May 26 14:11:51 2018 +0200
+++ b/dom/xbl/nsXBLBinding.cpp	Tue May 15 16:01:36 2018 -0700
@@ -963,7 +963,17 @@
   NS_ENSURE_TRUE(xblScope, NS_ERROR_UNEXPECTED);
 
   JS::Rooted<JSObject*> parent_proto(cx);
-  if (!JS_GetPrototype(cx, obj, &parent_proto)) {
+  {
+    JS::RootedObject wrapped(cx, obj);
+    JSAutoCompartment ac(cx, xblScope);
+    if (!JS_WrapObject(cx, &wrapped)) {
+      return NS_ERROR_FAILURE;
+    }
+    if (!JS_GetPrototype(cx, wrapped, &parent_proto)) {
+      return NS_ERROR_FAILURE;
+    }
+  }
+  if (!JS_WrapObject(cx, &parent_proto)) {
     return NS_ERROR_FAILURE;
   }
 
