diff -r a9bd7aeb9874 -r c8797e136acf netwerk/base/nsStandardURL.cpp
--- a/netwerk/base/nsStandardURL.cpp	Tue May 29 20:45:33 2018 +0200
+++ b/netwerk/base/nsStandardURL.cpp	Mon Jun 04 13:57:51 2018 +0200
@@ -27,7 +27,6 @@
 #include "nsReadableUtils.h"
 #include "mozilla/net/MozURL_ffi.h"
 
-
 //
 // setenv MOZ_LOG nsStandardURL:5
 //
@@ -3552,8 +3551,10 @@
         return false;
     }
 
+    CheckedInt<uint32_t> segmentLen = aSegment.position();
+    segmentLen += aSegment.length();
     // Make sure the segment does not extend beyond the spec.
-    if (NS_WARN_IF(aSegment.position() + aSegment.length() > aSpec.Length())) {
+    if (NS_WARN_IF(!segmentLen.isValid() || segmentLen.value() > aSpec.Length())) {
         return false;
     }
 
