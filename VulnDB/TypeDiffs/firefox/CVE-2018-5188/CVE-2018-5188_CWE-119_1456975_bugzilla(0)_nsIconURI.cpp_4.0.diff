diff -r 5a428c9953ab -r d31a2ab994fd image/decoders/icon/nsIconURI.cpp
--- a/image/decoders/icon/nsIconURI.cpp	Tue May 15 16:01:36 2018 -0700
+++ b/image/decoders/icon/nsIconURI.cpp	Wed May 02 14:53:13 2018 +0200
@@ -715,7 +715,17 @@
   mContentType = params.contentType();
   mFileName = params.fileName();
   mStockIcon = params.stockIcon();
+
+  if (params.iconSize() < -1 ||
+      params.iconSize() >= (int32_t) ArrayLength(kSizeStrings)) {
+    return false;
+  }
   mIconSize = params.iconSize();
+
+  if (params.iconState() < -1 ||
+      params.iconState() >= (int32_t) ArrayLength(kStateStrings)) {
+    return false;
+  }
   mIconState = params.iconState();
 
   return true;
