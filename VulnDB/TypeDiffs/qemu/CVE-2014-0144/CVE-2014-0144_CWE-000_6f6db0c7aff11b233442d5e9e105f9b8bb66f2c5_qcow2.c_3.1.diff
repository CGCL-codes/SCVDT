diff --git a/block/qcow2.c b/block/qcow2.c
index e4280a2cb5..a6ad44ef3a 100644
--- a/block/qcow2.c
+++ b/block/qcow2.c
@@ -514,6 +514,12 @@ static int qcow2_open(BlockDriverState *bs, QDict *options, int flags,
         }
     }
 
+    if (header.backing_file_offset > s->cluster_size) {
+        error_setg(errp, "Invalid backing file offset");
+        ret = -EINVAL;
+        goto fail;
+    }
+
     if (header.backing_file_offset) {
         ext_end = header.backing_file_offset;
     } else {
