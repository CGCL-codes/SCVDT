diff --git a/slirp/mbuf.c b/slirp/mbuf.c
index 5ff24559fd..0f45abd917 100644
--- a/slirp/mbuf.c
+++ b/slirp/mbuf.c
@@ -138,7 +138,7 @@ m_cat(struct mbuf *m, struct mbuf *n)
         * If there's no room, realloc
         */
        if (M_FREEROOM(m) < n->m_len)
-               m_inc(m,m->m_size+MINCSIZE);
+               m_inc(m, m->m_len + n->m_len);
 
        memcpy(m->m_data+m->m_len, n->m_data, n->m_len);
        m->m_len += n->m_len;
@@ -158,12 +158,12 @@ m_inc(struct mbuf *m, int size)
 
         if (m->m_flags & M_EXT) {
          datasize = m->m_data - m->m_ext;
-          m->m_ext = g_realloc(m->m_ext, size);
+          m->m_ext = g_realloc(m->m_ext, size + datasize);
          m->m_data = m->m_ext + datasize;
         } else {
          char *dat;
          datasize = m->m_data - m->m_dat;
-          dat = g_malloc(size);
+      dat = g_malloc(size + datasize);
          memcpy(dat, m->m_dat, m->m_size);
 
          m->m_ext = dat;
@@ -171,7 +171,7 @@ m_inc(struct mbuf *m, int size)
          m->m_flags |= M_EXT;
         }
 
-        m->m_size = size;
+        m->m_size = size + datasize;
 
 }
 
-- 
2.17.1



