Index: libpurple/protocols/msn/slplink.c
===================================================================
--- libpurple/protocols/msn/slplink.c	(revision 13143)
+++ libpurple/protocols/msn/slplink.c	(working copy)
@@ -596,9 +596,11 @@
 	}
 	else if (slpmsg->size)
 	{
-		if ((offset + len) > slpmsg->size)
+		if (G_MAXSIZE - len < offset || (offset + len) > slpmsg->size)
 		{
-			purple_debug_error("msn", "Oversized slpmsg - msgsize=%lld offset=%d len=%d\n", slpmsg->size, offset, len);
+			purple_debug_error("msn", "Oversized slpmsg - msgsize=%lld "
+					"offset=" G_GSIZE_FORMAT " len=" G_GSIZE_FORMAT "\n",
+					slpmsg->size, offset, len);
 			g_return_if_reached();
 		}
 		else
