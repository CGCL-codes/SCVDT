diff --git a/xen/common/tmem.c b/xen/common/tmem.c
index 63a9ed05e3..6ad0670c86 100644
--- a/xen/common/tmem.c
+++ b/xen/common/tmem.c
@@ -1873,6 +1873,8 @@ static NOINLINE int do_tmem_destroy_pool(uint32_t pool_id)
 
     if ( client->pools == NULL )
         return 0;
+    if ( pool_id >= MAX_POOLS_PER_DOMAIN )
+        return 0;
     if ( (pool = client->pools[pool_id]) == NULL )
         return 0;
     client->pools[pool_id] = NULL;
