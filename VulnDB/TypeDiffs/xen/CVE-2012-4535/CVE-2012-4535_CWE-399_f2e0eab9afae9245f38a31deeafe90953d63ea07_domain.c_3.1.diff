diff --git a/xen/common/domain.c b/xen/common/domain.c
index 98e36eee55..054f7c4e64 100644
--- a/xen/common/domain.c
+++ b/xen/common/domain.c
@@ -873,6 +873,9 @@ long do_vcpu_op(int cmd, int vcpuid, XEN_GUEST_HANDLE(void) arg)
         if ( set.period_ns < MILLISECS(1) )
             return -EINVAL;
 
+        if ( set.period_ns > STIME_DELTA_MAX )
+            return -EINVAL;
+
         v->periodic_period = set.period_ns;
         vcpu_force_reschedule(v);
 
