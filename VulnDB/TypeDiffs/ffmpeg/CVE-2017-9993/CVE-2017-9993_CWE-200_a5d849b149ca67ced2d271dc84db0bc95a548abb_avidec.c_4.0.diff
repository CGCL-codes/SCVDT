diff --git a/libavformat/avidec.c b/libavformat/avidec.c
index b6ef0ac62d0..df520920671 100644
--- a/libavformat/avidec.c
+++ b/libavformat/avidec.c
@@ -1099,6 +1099,9 @@ static int read_gab2_sub(AVFormatContext *s, AVStream *st, AVPacket *pkt)
         if (!sub_demuxer)
             goto error;
 
+        if (strcmp(sub_demuxer->name, "srt") && strcmp(sub_demuxer->name, "ass"))
+            goto error;
+
         if (!(ast->sub_ctx = avformat_alloc_context()))
             goto error;
 
