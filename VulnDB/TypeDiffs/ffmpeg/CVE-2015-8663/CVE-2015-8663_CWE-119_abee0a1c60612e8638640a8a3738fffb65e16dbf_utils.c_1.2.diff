diff --git a/libavcodec/utils.c b/libavcodec/utils.c
index e018e445f42..d00dfae4aca 100644
--- a/libavcodec/utils.c
+++ b/libavcodec/utils.c
@@ -888,8 +888,10 @@ static int get_buffer_internal(AVCodecContext *avctx, AVFrame *frame, int flags)
 int ff_get_buffer(AVCodecContext *avctx, AVFrame *frame, int flags)
 {
     int ret = get_buffer_internal(avctx, frame, flags);
-    if (ret < 0)
+    if (ret < 0) {
         av_log(avctx, AV_LOG_ERROR, "get_buffer() failed\n");
+        frame->width = frame->height = 0;
+    }
     return ret;
 }
 
