diff --git a/libavformat/avidec.c b/libavformat/avidec.c
index 0067ff98f2d..b78a3d2a2b4 100644
--- a/libavformat/avidec.c
+++ b/libavformat/avidec.c
@@ -1125,6 +1125,7 @@ static int avi_read_packet(AVFormatContext *s, AVPacket *pkt)
         err= av_get_packet(pb, pkt, size);
         if(err<0)
             return err;
+        size = err;
 
         if(ast->has_pal && pkt->data && pkt->size<(unsigned)INT_MAX/2){
             uint8_t *pal;
