diff --git a/util/decompile.c b/util/decompile.c
index 13e3b06..7486efd 100644
--- a/util/decompile.c
+++ b/util/decompile.c
@@ -334,7 +334,7 @@ getString(struct SWF_ACTIONPUSHPARAM *act)
 		}
 		else
 		{
-			t=malloc(4); /* Rdd */
+			t=malloc(5); /* Rddd */
 			sprintf(t,"R%d", act->p.RegisterNumber );
 			return t;
 		}
@@ -344,9 +344,19 @@ getString(struct SWF_ACTIONPUSHPARAM *act)
 		else
 			return "false";
 	case PUSH_DOUBLE: /* DOUBLE */
-		t=malloc(10); /* big enough? */
-		sprintf(t,"%g", act->p.Double );
+	{
+		char length_finder[1];
+		int needed_length = snprintf(length_finder, 1, "%g", act->p.Double) + 1;
+		if (needed_length <= 0)
+		{
+		        SWF_warn("WARNING: could not evaluate size of buffer (memory issue ?).\n");
+		        break;
+		}
+
+		t = malloc(needed_length);
+		sprintf(t, "%g", act->p.Double );
 		return t;
+	}
 	case PUSH_INT: /* INTEGER */
 		t=malloc(10); /* 32-bit decimal */
 		sprintf(t,"%ld", act->p.Integer );
@@ -417,7 +427,7 @@ getName(struct SWF_ACTIONPUSHPARAM *act)
 		}
 #if 0
 	  case 4: /* REGISTER */
-                t=malloc(4); /* Rdd */
+		t=malloc(5); /* Rddd */
   		sprintf(t,"R%d", act->p.RegisterNumber );
   		return t;
 #endif
