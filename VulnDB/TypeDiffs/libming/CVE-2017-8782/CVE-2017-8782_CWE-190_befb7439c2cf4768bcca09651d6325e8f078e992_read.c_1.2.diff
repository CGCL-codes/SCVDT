diff --git a/util/read.c b/util/read.c
index b429695..892e754 100644
--- a/util/read.c
+++ b/util/read.c
@@ -20,6 +20,7 @@
  *
  ****************************************************************************/
 
+#include <limits.h>
 #include <stdarg.h>
 #include <stdio.h>
 #include <stdlib.h>
@@ -236,23 +237,33 @@ char *readBytes(FILE *f,int size)
 
 char *readString(FILE *f)
 {
-  int len = 0, buflen = 256;
+  unsigned int len = 0, buflen = 256;
   char c, *buf, *p;
 
-  buf = (char *)malloc(sizeof(char)*256);
+  buf = (char *)malloc(sizeof(char)*buflen);
+  if ( ! buf )
+  {
+    fprintf(stderr, "failed allocating %d bytes\n", buflen);
+    exit(-1);
+  }
   p = buf;
 
   while((c=(char)readUInt8(f)) != '\0')
   {
     if(len >= buflen-2)
     {
-      buf = (char *)realloc(buf, sizeof(char)*(buflen+256));
-      if ( ! buf )
+      if ( buflen >= UINT_MAX - 256 )
       {
-        fprintf(stderr, "failed reallocating %d bytes\n", buflen+256);
+        fprintf(stderr, "string null-termination missing after reading %d bytes, giving up\n", buflen);
         exit(-1);
       }
       buflen += 256;
+      buf = (char *)realloc(buf, sizeof(char)*(buflen));
+      if ( ! buf )
+      {
+        fprintf(stderr, "failed allocating %d bytes\n", buflen);
+        exit(-1);
+      }
       p = buf+len;
     }
 
