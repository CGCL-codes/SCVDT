diff --git a/util/old/listswf.c b/util/old/listswf.c
index f8bbe12..203fcb7 100755
--- a/util/old/listswf.c
+++ b/util/old/listswf.c
@@ -1649,6 +1649,11 @@ void printMP3Headers(FILE *f, int length)
     flags += fgetc(f) << 16;
     flags += fgetc(f) << 8;
     flags += fgetc(f);
+    if (feof(f))
+    {
+      fprintf(stderr, "truncated file\n");
+      exit(-1);
+    }
 
     fileOffset += 4;
 
