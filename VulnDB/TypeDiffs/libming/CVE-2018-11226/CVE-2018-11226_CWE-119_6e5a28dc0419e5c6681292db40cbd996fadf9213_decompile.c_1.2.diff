diff --git a/util/decompile.c b/util/decompile.c
index 00f8095..d55365f 100644
--- a/util/decompile.c
+++ b/util/decompile.c
@@ -964,6 +964,24 @@ decompileGETURL2 (SWF_ACTION *act)
 	return 0;
 }
 
+static inline int Offset(SWF_ACTION *actions, int n, int maxn)
+{
+	if(!n || n >= maxn)
+	{
+#if DEBUG
+		SWF_warn("Offset: want %i, max %i\n", n, maxn);
+#endif
+		return -999;
+	} else if (n < 1) {
+
+#if DEBUG
+		SWF_warn("Offset: want %i < 1\n", n);
+#endif
+		return -998;
+	}
+	return actions[n].SWF_ACTIONRECORD.Offset;
+}
+
 static inline int OpCode(SWF_ACTION *actions, int n, int maxn)
 {
 	if(!n || n >= maxn)
@@ -2126,7 +2144,7 @@ decompile_SWITCH(int n, SWF_ACTION *actions, int maxn, int off1end)
 	int offSave;
 	for (i=0; i<n_firstactions; i++) // seek last op in 1st if
 	{
-		if (actions[i+1].SWF_ACTIONRECORD.Offset==off1end)
+		if (Offset(actions, i+1, maxn) == off1end)
 		{
 			// println("found #off end first= %d",i+1);
 			if (OpCode(actions, i, maxn) == SWFACTION_JUMP)
