Index: src/cff.cc
===================================================================
--- src/cff.cc	(revision 30)
+++ src/cff.cc	(working copy)
@@ -822,6 +822,9 @@
   if (!table.ReadU8(&off_size)) {
     return OTS_FAILURE();
   }
+  if ((off_size == 0) || (off_size > 4)) {
+    return OTS_FAILURE();
+  }
 
   if ((major != 1) ||
       (minor != 0) ||