--- decode.c	2016-02-03 04:18:57.000000000 -0500
+++ ../decode.c	2016-02-03 04:59:31.808368934 -0500
@@ -1752,6 +1752,9 @@
   }
 postSelfintersecting:
   while (--i >= 0) {
+    if (pos < 0 || pos >= s->ringbuffer_size) {
+      return BROTLI_RESULT_ERROR;
+    }
     s->ringbuffer[pos] =
         s->ringbuffer[(pos - s->distance_code) & s->ringbuffer_mask];
     ++pos;