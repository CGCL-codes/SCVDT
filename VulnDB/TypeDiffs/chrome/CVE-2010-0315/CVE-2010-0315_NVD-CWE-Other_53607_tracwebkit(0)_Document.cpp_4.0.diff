Index: /trunk/WebCore/dom/Document.cpp

===================================================================

--- /trunk/WebCore/dom/Document.cpp	(revision 53606)

+++ /trunk/WebCore/dom/Document.cpp	(revision 53607)

@@ -2010,7 +2010,7 @@

 

     if (m_elemSheet)

-        m_elemSheet->setHref(m_baseURL.string());

+        m_elemSheet->setBaseURL(m_baseURL);

     if (m_mappedElementSheet)

-        m_mappedElementSheet->setHref(m_baseURL.string());

+        m_mappedElementSheet->setBaseURL(m_baseURL);

 }

 

@@ -2034,5 +2034,5 @@

     

     // Parse the sheet and cache it.

-    m_pageUserSheet = CSSStyleSheet::create(this, settings()->userStyleSheetLocation());

+    m_pageUserSheet = CSSStyleSheet::createInline(this, settings()->userStyleSheetLocation());

     m_pageUserSheet->setIsUserStyleSheet(true);

     m_pageUserSheet->parseString(userSheetText, !inCompatMode());

@@ -2069,5 +2069,5 @@

             if (!UserContentURLPattern::matchesPatterns(url(), sheet->whitelist(), sheet->blacklist()))

                 continue;

-            RefPtr<CSSStyleSheet> parsedSheet = CSSStyleSheet::create(const_cast<Document*>(this), sheet->url());

+            RefPtr<CSSStyleSheet> parsedSheet = CSSStyleSheet::createInline(const_cast<Document*>(this), sheet->url());

             parsedSheet->setIsUserStyleSheet(true);

             parsedSheet->parseString(sheet->source(), !inCompatMode());

@@ -2091,5 +2091,5 @@

 {

     if (!m_elemSheet)

-        m_elemSheet = CSSStyleSheet::create(this, m_baseURL.string());

+        m_elemSheet = CSSStyleSheet::createInline(this, m_baseURL);

     return m_elemSheet.get();

 }

@@ -2098,5 +2098,5 @@

 {

     if (!m_mappedElementSheet)

-        m_mappedElementSheet = CSSStyleSheet::create(this, m_baseURL.string());

+        m_mappedElementSheet = CSSStyleSheet::createInline(this, m_baseURL);

     return m_mappedElementSheet.get();

 }

