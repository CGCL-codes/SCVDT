Index: /trunk/WebCore/xml/XSLStyleSheetLibxslt.cpp

===================================================================

--- /trunk/WebCore/xml/XSLStyleSheetLibxslt.cpp	(revision 53606)

+++ /trunk/WebCore/xml/XSLStyleSheetLibxslt.cpp	(revision 53607)

@@ -56,6 +56,6 @@

 namespace WebCore {

 

-XSLStyleSheet::XSLStyleSheet(XSLImportRule* parentRule, const String& href)

-    : StyleSheet(parentRule, href)

+XSLStyleSheet::XSLStyleSheet(XSLImportRule* parentRule, const String& href, const KURL& baseURL)

+    : StyleSheet(parentRule, href, baseURL)

     , m_ownerDocument(0)

     , m_embedded(false)

@@ -67,6 +67,6 @@

 }

 

-XSLStyleSheet::XSLStyleSheet(Node* parentNode, const String& href,  bool embedded)

-    : StyleSheet(parentNode, href)

+XSLStyleSheet::XSLStyleSheet(Node* parentNode, const String& href, const KURL& baseURL,  bool embedded)

+    : StyleSheet(parentNode, href, baseURL)

     , m_ownerDocument(parentNode->document())

     , m_embedded(embedded)

@@ -169,5 +169,5 @@

 

     m_stylesheetDoc = xmlCtxtReadMemory(ctxt, buffer, size,

-        href().utf8().data(),

+        putativeBaseURL().string().utf8().data(),

         BOMHighByte == 0xFF ? "UTF-16LE" : "UTF-16BE",

         XML_PARSE_NOENT | XML_PARSE_DTDATTR | XML_PARSE_NOWARNING | XML_PARSE_NOCDATA);

@@ -193,5 +193,5 @@

         // We have to locate (by ID) the appropriate embedded stylesheet element, so that we can walk the

         // import/include list.

-        xmlAttrPtr idNode = xmlGetID(document(), (const xmlChar*)(href().utf8().data()));

+        xmlAttrPtr idNode = xmlGetID(document(), (const xmlChar*)(putativeBaseURL().string().utf8().data()));

         if (!idNode)

             return;

