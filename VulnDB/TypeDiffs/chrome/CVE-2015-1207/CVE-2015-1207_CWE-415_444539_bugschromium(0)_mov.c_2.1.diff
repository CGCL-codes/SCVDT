diff --git a/libavformat/mov.c b/libavformat/mov.c
index 72fa15c..f9f054f 100644
--- a/libavformat/mov.c
+++ b/libavformat/mov.c
@@ -212,6 +212,9 @@ static int mov_read_covr(MOVContext *c, AVIOContext *pb, int type, int len)
 static int mov_metadata_raw(MOVContext *c, AVIOContext *pb,
                             unsigned len, const char *key)
 {
+    // Check for overflow.
+    if (len >= INT_MAX)
+        return AVERROR(EINVAL);
     char *value = av_malloc(len + 1);
     if (!value)
         return AVERROR(ENOMEM);
