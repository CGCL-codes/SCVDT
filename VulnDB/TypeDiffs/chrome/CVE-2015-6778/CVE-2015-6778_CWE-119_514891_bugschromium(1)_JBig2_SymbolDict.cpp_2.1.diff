diff --git core/src/fxcodec/jbig2/JBig2_SymbolDict.cpp core/src/fxcodec/jbig2/JBig2_SymbolDict.cpp
index 2287b91..762b982 100644
--- core/src/fxcodec/jbig2/JBig2_SymbolDict.cpp
+++ core/src/fxcodec/jbig2/JBig2_SymbolDict.cpp
@@ -8,14 +8,16 @@
 CJBig2_SymbolDict::CJBig2_SymbolDict() {
   SDNUMEXSYMS = 0;
   SDEXSYMS = NULL;
-  m_bContextRetained = FALSE;
+  m_dwgbContextRetainedSize = m_dwgrContextRetainedSize = 0;
   m_gbContext = m_grContext = NULL;
 }
 
 CJBig2_SymbolDict* CJBig2_SymbolDict::DeepCopy() {
   CJBig2_SymbolDict* dst = NULL;
   CJBig2_SymbolDict* src = this;
-  if (src->m_bContextRetained || src->m_gbContext || src->m_grContext) {
+  if (src->m_dwgbContextRetainedSize > 0 ||
+      src->m_dwgrContextRetainedSize > 0 || src->m_gbContext ||
+      src->m_grContext) {
     return NULL;
   }
   JBIG2_ALLOC(dst, CJBig2_SymbolDict());
@@ -39,12 +41,10 @@ CJBig2_SymbolDict::~CJBig2_SymbolDict() {
     }
     m_pModule->JBig2_Free(SDEXSYMS);
   }
-  if (m_bContextRetained) {
-    if (m_gbContext) {
-      m_pModule->JBig2_Free(m_gbContext);
-    }
-    if (m_grContext) {
-      m_pModule->JBig2_Free(m_grContext);
-    }
+  if (m_dwgbContextRetainedSize > 0 && m_gbContext) {
+    m_pModule->JBig2_Free(m_gbContext);
+  }
+  if (m_dwgrContextRetainedSize > 0 && m_grContext) {
+    m_pModule->JBig2_Free(m_grContext);
   }
 }
