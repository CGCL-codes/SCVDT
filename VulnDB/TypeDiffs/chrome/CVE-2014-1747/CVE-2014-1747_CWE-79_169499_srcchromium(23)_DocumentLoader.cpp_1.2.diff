--- trunk/Source/core/loader/DocumentLoader.cpp	2014/03/18 23:20:35	169498
+++ trunk/Source/core/loader/DocumentLoader.cpp	2014/03/18 23:22:33	169499
@@ -589,6 +589,10 @@
 
 bool DocumentLoader::maybeCreateArchive()
 {
+    // Only the top-frame can load MHTML.
+    if (m_frame->tree().parent())
+        return false;
+
     // Give the archive machinery a crack at this document. If the MIME type is not an archive type, it will return 0.
     if (!isArchiveMIMEType(m_response.mimeType()))
         return false;
@@ -608,6 +612,9 @@
     // relative URLs are resolved properly.
     ensureWriter(mainResource->mimeType(), m_archive->mainResource()->url());
 
+    // The Document has now been created.
+    document()->enforceSandboxFlags(SandboxAll);
+
     commitData(mainResource->data()->data(), mainResource->data()->size());
     return true;
 }
