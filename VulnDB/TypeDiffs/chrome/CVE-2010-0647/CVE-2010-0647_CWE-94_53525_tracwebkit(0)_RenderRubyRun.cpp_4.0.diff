Index: /trunk/WebCore/rendering/RenderRubyRun.cpp

===================================================================

--- /trunk/WebCore/rendering/RenderRubyRun.cpp	(revision 53524)

+++ /trunk/WebCore/rendering/RenderRubyRun.cpp	(revision 53525)

@@ -149,5 +149,5 @@

             ruby->addChild(newRun, this);

             newRun->addChild(child);

-            rubyBaseSafe()->splitToLeft(newRun->rubyBaseSafe(), beforeChild);

+            rubyBaseSafe()->moveChildren(newRun->rubyBaseSafe(), beforeChild);

         }

     } else {

@@ -171,5 +171,9 @@

             RenderRubyRun* rightRun = static_cast<RenderRubyRun*>(rightNeighbour);

             ASSERT(rightRun->hasRubyBase());

-            base->mergeWithRight(rightRun->rubyBaseSafe());

+            RenderRubyBase* rightBase = rightRun->rubyBaseSafe();

+            // Collect all children in a single base, then swap the bases.

+            rightBase->moveChildren(base);

+            moveChildTo(rightRun, rightRun->children(), base);

+            rightRun->moveChildTo(this, children(), rightBase);

             // The now empty ruby base will be removed below.

         }

