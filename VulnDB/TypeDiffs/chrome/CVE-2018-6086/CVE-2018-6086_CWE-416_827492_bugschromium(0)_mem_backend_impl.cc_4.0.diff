diff --git a/net/disk_cache/memory/mem_backend_impl.cc b/net/disk_cache/memory/mem_backend_impl.cc
index 865d19c..de24dcb 100644
--- a/net/disk_cache/memory/mem_backend_impl.cc
+++ b/net/disk_cache/memory/mem_backend_impl.cc
@@ -8,6 +8,7 @@
 #include <functional>
 #include <memory>
 #include <utility>
+#include <vector>
 
 #include "base/logging.h"
 #include "base/sys_info.h"
@@ -333,8 +334,13 @@ void MemBackendImpl::EvictIfNeeded() {
   while (current_size_ > target_size && entry != lru_list_.end()) {
     MemEntryImpl* to_doom = entry->value();
     entry = entry->next();
-    if (!to_doom->InUse())
+    if (!to_doom->InUse()) {
+      bool is_parent = to_doom->type() == MemEntryImpl::PARENT_ENTRY;
       to_doom->Doom();
+      // We could have invalidated entry if to_doom had children.
+      if (is_parent)
+        entry = lru_list_.head();
+    }
   }
 }
 
