diff -uprN linux-2.6.24.7.noarch.default/net/dccp/proto.c linux-2.6.24.7.noarch/net/dccp/proto.c
--- linux-2.6.24.7.noarch.default/net/dccp/proto.c	2008-01-24 17:58:37.000000000 -0500
+++ linux-2.6.24.7.noarch/net/dccp/proto.c	2008-08-20 00:00:22.453458000 -0400
@@ -458,6 +458,11 @@ static int dccp_setsockopt_change(struct
 
 	if (copy_from_user(&opt, optval, sizeof(opt)))
 		return -EFAULT;
+	/*
+	 * rfc4340: 6.1. Change Options
+	 */
+	if (opt.dccpsf_len < 1)
+		return -EINVAL;
 
 	val = kmalloc(opt.dccpsf_len, GFP_KERNEL);
 	if (!val)
