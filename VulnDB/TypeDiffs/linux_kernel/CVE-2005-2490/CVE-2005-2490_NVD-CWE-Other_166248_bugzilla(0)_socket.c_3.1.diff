diff -urN RC13-rc6-git8-base/net/socket.c sendmsg-fix/net/socket.c
--- RC13-rc6-git8-base/net/socket.c	2005-08-10 10:37:54.000000000 -0400
+++ sendmsg-fix/net/socket.c	2005-08-17 19:13:24.000000000 -0400
@@ -1739,10 +1739,11 @@
 		goto out_freeiov;
 	ctl_len = msg_sys.msg_controllen; 
 	if ((MSG_CMSG_COMPAT & flags) && ctl_len) {
-		err = cmsghdr_from_user_compat_to_kern(&msg_sys, ctl, sizeof(ctl));
+		err = cmsghdr_from_user_compat_to_kern(&msg_sys, sock->sk, ctl, sizeof(ctl));
 		if (err)
 			goto out_freeiov;
 		ctl_buf = msg_sys.msg_control;
+		ctl_len = msg_sys.msg_controllen; 
 	} else if (ctl_len) {
 		if (ctl_len > sizeof(ctl))
 		{
