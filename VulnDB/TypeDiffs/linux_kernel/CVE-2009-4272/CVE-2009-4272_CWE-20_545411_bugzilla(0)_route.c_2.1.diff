diff --git a/net/ipv4/route.c b/net/ipv4/route.c
index f902549..cdb990a 100644
--- a/net/ipv4/route.c
+++ b/net/ipv4/route.c
@@ -1098,7 +1098,13 @@ restart:
 				       "limit, route caching disabled\n",
 				rt->u.dst.dev->name, current_rt_cache_rebuild_count);
 			}
+
+			/* We need to unlock here, flushing the cache will lock each chain */
+			spin_unlock_bh(rt_hash_lock_addr(hash));
 			rt_emergency_hash_rebuild();
+
+			/* Start over, someone might have inserted right after the flush */
+			goto restart;
 		}
 	}
 
