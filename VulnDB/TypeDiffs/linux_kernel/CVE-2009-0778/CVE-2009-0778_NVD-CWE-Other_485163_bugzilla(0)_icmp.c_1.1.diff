diff --git a/net/ipv4/icmp.c b/net/ipv4/icmp.c
index 69c7734..9622722 100644
--- a/net/ipv4/icmp.c
+++ b/net/ipv4/icmp.c
@@ -577,7 +577,7 @@ void icmp_send(struct sk_buff *skb_in, int type, int code, u32 info)
 			rt = NULL;
 			break;
 		default:
-			goto out_unlock;
+			goto ende;
 		}
 
 		xfrm4_decode_session_reverse(skb_in, &fl);
@@ -590,7 +590,7 @@ void icmp_send(struct sk_buff *skb_in, int type, int code, u32 info)
 
 			fl2.fl4_dst = fl.fl4_src;
 			if (ip_route_output_key(&rt2, &fl2))
-				goto relookup_failed;
+				goto ende;
 
 			/* Ugh! */
 			odst = skb_in->dst;
