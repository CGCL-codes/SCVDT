diff --git a/ssl/s3_clnt.c b/ssl/s3_clnt.c
index 34efff8c73..cd43873e56 100644
--- a/ssl/s3_clnt.c
+++ b/ssl/s3_clnt.c
@@ -1037,6 +1037,7 @@ int ssl3_get_server_hello(SSL *s)
 			{
 			s->session->cipher = pref_cipher ?
 				pref_cipher : ssl_get_cipher_by_char(s, p+j);
+	    		s->s3->flags |= SSL3_FLAGS_CCS_OK;
 			}
 		}
 #endif /* OPENSSL_NO_TLSEXT */
