diff --git a/ssl/t1_lib.c b/ssl/t1_lib.c
index f3c5a16e48..bde52b126b 100644
--- a/ssl/t1_lib.c
+++ b/ssl/t1_lib.c
@@ -637,6 +637,7 @@ int ssl_parse_clienthello_tlsext(SSL *s, unsigned char **p, unsigned char *d, in
 						s->session->tlsext_hostname[len]='\0';
 						if (strlen(s->session->tlsext_hostname) != len) {
 							OPENSSL_free(s->session->tlsext_hostname);
+							s->session->tlsext_hostname = NULL;
 							*al = TLS1_AD_UNRECOGNIZED_NAME;
 							return 0;
 						}
