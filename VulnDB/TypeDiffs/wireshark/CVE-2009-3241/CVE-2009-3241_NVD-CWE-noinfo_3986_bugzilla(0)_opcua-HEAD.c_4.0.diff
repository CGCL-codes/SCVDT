--- C:/Users/MartinL/AppData/Local/Temp/opcua-HEAD.c	Wed Dec 16 11:15:39 2009

+++ c:/wireshark/plugins/opcua/opcua.c	Wed Dec 16 11:07:31 2009

@@ -167,32 +167,32 @@

     col_set_str(pinfo->cinfo, COL_PROTOCOL, "OpcUa");

 

     /* parse message type */

-    if (tvb_memeql(tvb, 0, "HEL", 3))

+    if (tvb_memeql(tvb, 0, "HEL", 3) == 0)

     {

         msgtype = MSG_HELLO;

         pfctParse = parseHello;

     }

-    else if (tvb_memeql(tvb, 0, "ACK", 3))

+    else if (tvb_memeql(tvb, 0, "ACK", 3) == 0)

     {

         msgtype = MSG_ACKNOWLEDGE;

         pfctParse = parseAcknowledge;

     }

-    else if (tvb_memeql(tvb, 0, "ERR", 3))

+    else if (tvb_memeql(tvb, 0, "ERR", 3) == 0)

     {

         msgtype = MSG_ERROR;

         pfctParse = parseError;

     }

-    else if (tvb_memeql(tvb, 0, "MSG", 3))

+    else if (tvb_memeql(tvb, 0, "MSG", 3) == 0)

     {

         msgtype = MSG_MESSAGE;

         pfctParse = parseMessage;

     }

-    else if (tvb_memeql(tvb, 0, "OPN", 3))

+    else if (tvb_memeql(tvb, 0, "OPN", 3) == 0)

     {

         msgtype = MSG_OPENSECURECHANNEL;

         pfctParse = parseOpenSecureChannel;

     }

-    else if (tvb_memeql(tvb, 0, "CLO", 3))

+    else if (tvb_memeql(tvb, 0, "CLO", 3) == 0)

     {

         msgtype = MSG_CLOSESECURECHANNEL;

         pfctParse = parseCloseSecureChannel;

