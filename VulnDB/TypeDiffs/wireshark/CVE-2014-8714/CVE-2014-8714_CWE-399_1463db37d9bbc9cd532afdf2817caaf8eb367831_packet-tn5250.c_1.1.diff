diff --git a/epan/dissectors/packet-tn5250.c b/epan/dissectors/packet-tn5250.c
index 86e2b06..441fa30 100644
--- a/epan/dissectors/packet-tn5250.c
+++ b/epan/dissectors/packet-tn5250.c
@@ -4729,7 +4729,12 @@ dissect_write_structured_field(proto_tree *tn5250_tree, tvbuff_t *tvb, gint offs
             offset += tn5250_add_hf_items(tn5250_tree, tvb, offset,
                                           dfdpck_top_row_fields);
           } else {
-            offset += dissect_unknown_data(tn5250_tree, tvb, offset, start, length);
+            guint32 step;
+
+            step = dissect_unknown_data(tn5250_tree, tvb, offset, start, length);
+            if (step==0)
+              break;
+            offset += step;
           }
         }
         break;
-- 
2.7.4

