diff --git a/epan/packet.c b/epan/packet.c
index e043a0d..8316432 100644
--- a/epan/packet.c
+++ b/epan/packet.c
@@ -1459,6 +1459,7 @@ dissector_get_string_handle(dissector_table_t sub_dissectors,
 {
 	dtbl_entry_t *dtbl_entry;
 
+	if (!string) return 0;
 	dtbl_entry = find_string_dtbl_entry(sub_dissectors, string);
 	if (dtbl_entry != NULL)
 		return dtbl_entry->current;
@@ -1469,8 +1470,10 @@ dissector_get_string_handle(dissector_table_t sub_dissectors,
 dissector_handle_t
 dissector_get_default_string_handle(const char *name, const gchar *string)
 {
-	dissector_table_t sub_dissectors = find_dissector_table(name);
+	dissector_table_t sub_dissectors;
 
+	if (!string) return 0;
+	sub_dissectors = find_dissector_table(name);
 	if (sub_dissectors != NULL) {
 		dtbl_entry_t *dtbl_entry = find_string_dtbl_entry(sub_dissectors, string);
 		if (dtbl_entry != NULL)
-- 
2.7.4

