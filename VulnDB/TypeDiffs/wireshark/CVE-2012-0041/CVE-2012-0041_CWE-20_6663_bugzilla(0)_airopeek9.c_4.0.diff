Index: wiretap/airopeek9.c
===================================================================
--- wiretap/airopeek9.c	(revision 40162)
+++ wiretap/airopeek9.c	(working copy)
@@ -391,9 +391,10 @@
 		return 0;
 	    }
 	    hdr_info->length = pletohl(&tag_value[2]);
+		hdr_info->length = min(hdr_info->length, WTAP_MAX_PACKET_SIZE);
 	    saw_length = TRUE;
 	    break;
-    
+
 	case TAG_AIROPEEK_V9_TIMESTAMP_LOWER:
 	    if (saw_timestamp_lower) {
 		*err = WTAP_ERR_BAD_RECORD;
