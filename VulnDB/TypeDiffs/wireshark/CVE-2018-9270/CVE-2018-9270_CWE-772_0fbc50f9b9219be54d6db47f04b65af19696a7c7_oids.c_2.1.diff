diff --git a/epan/oids.c b/epan/oids.c
index 5230c37..afa632d 100644
--- a/epan/oids.c
+++ b/epan/oids.c
@@ -946,6 +946,7 @@ guint oid_string2subid(wmem_allocator_t *scope, const char* str, guint32** subid
 			subid += *r - '0';
 
 			if( subids >= subids_overflow ||  subid > 0xffffffff) {
+				wmem_free(scope, *subids_p);
 				*subids_p=NULL;
 				return 0;
 			}
-- 
2.7.4

