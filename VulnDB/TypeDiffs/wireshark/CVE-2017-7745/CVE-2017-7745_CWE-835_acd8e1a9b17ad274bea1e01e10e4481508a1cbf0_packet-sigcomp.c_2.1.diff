diff --git a/epan/dissectors/packet-sigcomp.c b/epan/dissectors/packet-sigcomp.c
index 546b5dd..37f137e 100644
--- a/epan/dissectors/packet-sigcomp.c
+++ b/epan/dissectors/packet-sigcomp.c
@@ -2481,8 +2481,10 @@ execute_next_instruction:
                 handle_now = byte_copy_right - position;
             }
 
-            if (k + handle_now >= UDVM_MEMORY_SIZE)
+            if ((k + handle_now >= UDVM_MEMORY_SIZE) ||
+                (n + handle_now >= UDVM_MEMORY_SIZE)) {
                 goto decompression_failure;
+            }
             sha1_update( &ctx, &buff[k], handle_now );
 
             k = ( k + handle_now ) & 0xffff;
-- 
2.7.4

