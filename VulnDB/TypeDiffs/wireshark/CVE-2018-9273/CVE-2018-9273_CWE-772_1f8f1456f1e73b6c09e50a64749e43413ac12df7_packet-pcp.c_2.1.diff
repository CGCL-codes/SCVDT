diff --git a/epan/dissectors/packet-pcp.c b/epan/dissectors/packet-pcp.c
index 5beaed5..67ee4f6 100644
--- a/epan/dissectors/packet-pcp.c
+++ b/epan/dissectors/packet-pcp.c
@@ -1628,7 +1628,7 @@ static int dissect_pcp_message(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tr
     pcp_conv_info = (pcp_conv_info_t*)conversation_get_proto_data(conversation, proto_pcp);
 
     if(pcp_conv_info == NULL) {
-        pcp_conv_info = (pcp_conv_info_t*)g_malloc(sizeof(pcp_conv_info_t));
+        pcp_conv_info = (pcp_conv_info_t*)wmem_alloc(wmem_file_scope(), sizeof(pcp_conv_info_t));
         conversation_add_proto_data(conversation, proto_pcp, pcp_conv_info);
 
         pcp_conv_info->pmid_name_candidates = wmem_array_new(wmem_file_scope(), sizeof(guint8 *));
-- 
2.7.4

