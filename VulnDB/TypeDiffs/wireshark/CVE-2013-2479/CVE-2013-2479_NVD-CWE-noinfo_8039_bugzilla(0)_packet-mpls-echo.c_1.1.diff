diff --git a/epan/dissectors/packet-mpls-echo.c b/epan/dissectors/packet-mpls-echo.c
index d260343..1e68174 100644
--- a/epan/dissectors/packet-mpls-echo.c
+++ b/epan/dissectors/packet-mpls-echo.c
@@ -1084,20 +1084,22 @@ dissect_mpls_echo_tlv_dd_map(tvbuff_t *tvb, packet_info *pinfo, guint offset, pr
                                    offset + 14, 2, ENC_BIG_ENDIAN);
     }
 
-    /* Get the Sub-tlv Type and Length */
-    subtlv_type   = tvb_get_ntohs(tvb, offset + 16);
-    subtlv_length = tvb_get_ntohs(tvb, offset + 18);
-
-    rem    -= 20;
-    offset += 20;
-    if (rem < subtlv_length){
-        expert_add_info_format(pinfo, ddti, PI_MALFORMED, PI_ERROR,
-                               "Invalid Sub-tlv Length (claimed %u, found %u)",
-                               subtlv_length, rem);
-        return;
-    }
+    rem    -= 16;
+    offset += 16;
 
     while (rem > 4) {
+       /* Get the Sub-tlv Type and Length */
+       subtlv_type   = tvb_get_ntohs(tvb, offset);
+       subtlv_length = tvb_get_ntohs(tvb, offset+2);
+       rem -= 4;
+       offset += 4;
+
+       if (rem<subtlv_length){
+          expert_add_info_format(pinfo, ddti, PI_MALFORMED, PI_ERROR,
+                "Invalid Sub-tlv Length (claimed %u, found %u)",
+                subtlv_length, rem);
+          return;
+       }
 
         switch (subtlv_type) {
         case TLV_FEC_MULTIPATH_DATA:
