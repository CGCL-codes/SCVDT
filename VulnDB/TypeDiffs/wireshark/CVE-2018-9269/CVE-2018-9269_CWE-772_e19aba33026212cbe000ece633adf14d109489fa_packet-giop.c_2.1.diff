diff --git a/epan/dissectors/packet-giop.c b/epan/dissectors/packet-giop.c
index 4cbaabf..2a57cd5 100644
--- a/epan/dissectors/packet-giop.c
+++ b/epan/dissectors/packet-giop.c
@@ -1712,7 +1712,7 @@ static gchar * get_modname_from_repoid(gchar *repoid) {
 
   /* Now create a new string based on start and stop and \0 */
 
-  modname = g_strndup(repoid+4, stop_mod - start_mod);
+  modname = wmem_strndup(wmem_packet_scope(), repoid+4, stop_mod - start_mod);
 
   return modname;
 
-- 
2.7.4

