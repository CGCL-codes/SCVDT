Index: libtiff/tif_color.c
===================================================================
RCS file: /cvs/maptools/cvsroot/libtiff/libtiff/tif_color.c,v
retrieving revision 1.11
retrieving revision 1.12
diff -a -u -r1.11 -r1.12
--- libtiff/tif_color.c	23 Nov 2005 22:20:56 -0000	1.11
+++ libtiff/tif_color.c	9 Feb 2006 15:42:20 -0000	1.12
@@ -1,4 +1,4 @@
-/* $Id: tif_color.c,v 1.11 2005/11/23 22:20:56 dron Exp $ */
+/* $Id: tif_color.c,v 1.12 2006/02/09 15:42:20 dron Exp $ */
 
 /*
  * Copyright (c) 1988-1997 Sam Leffler
@@ -92,6 +92,11 @@
 	Yg = TIFFmax(Yg, cielab->display.d_Y0G);
 	Yb = TIFFmax(Yb, cielab->display.d_Y0B);
 
+	/* Avoid overflow in case of wrong input values */
+	Yr = TIFFmin(Yr, cielab->display.d_YCR);
+	Yg = TIFFmin(Yg, cielab->display.d_YCG);
+	Yb = TIFFmin(Yb, cielab->display.d_YCB);
+
 	/* Turn luminosity to colour value. */
 	i = (int)((Yr - cielab->display.d_Y0R) / cielab->rstep);
 	i = TIFFmin(cielab->range, i);
