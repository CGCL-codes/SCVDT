diff --git a/libtiff/tif_fax3.c b/libtiff/tif_fax3.c
index 9429535c..da4115f4 100644
--- a/libtiff/tif_fax3.c
+++ b/libtiff/tif_fax3.c
@@ -504,8 +504,11 @@ Fax3SetupState(TIFF* tif)
 	    td->td_compression == COMPRESSION_CCITTFAX4
 	);
 
-	nruns = needsRefLine ? 2*TIFFroundup_32(rowpixels,32) : rowpixels;
-	nruns += 3;
+	/* TIFFroundup_32 returns zero on internal overflow */
+	nruns = TIFFroundup_32(rowpixels,32);
+	if (needsRefLine) {
+		nruns *= 2;
+	}
 	dsp->runs = (uint32*) _TIFFCheckMalloc(tif, 2*nruns, sizeof (uint32),
 					  "for Group 3/4 run arrays");
 	if (dsp->runs == NULL)
