diff --git a/libtiff/tif_fax3.c b/libtiff/tif_fax3.c
index 954fa7c6..47314a34 100644
--- a/libtiff/tif_fax3.c
+++ b/libtiff/tif_fax3.c
@@ -493,8 +493,11 @@ Fax3SetupState(TIFF* tif)
 	    td->td_compression == COMPRESSION_CCITTFAX4
 	);
 
-	nruns = needsRefLine ? 2*TIFFroundup(rowpixels,32) : rowpixels;
-	nruns += 3;
+	/* TIFFroundup returns zero on internal overflow */
+	nruns = TIFFroundup(rowpixels,32);
+	if (needsRefLine) {
+		nruns *= 2;
+	}
 	dsp->runs = (uint32*) _TIFFCheckMalloc(tif, 2*nruns, sizeof (uint32),
 					  "for Group 3/4 run arrays");
 	if (dsp->runs == NULL)
