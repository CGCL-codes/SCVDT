diff --git a/tools/gif2tiff.c b/tools/gif2tiff.c
index 97ed45db..75696e5a 100644
--- a/tools/gif2tiff.c
+++ b/tools/gif2tiff.c
@@ -275,11 +275,15 @@ readgifimage(char* mode)
     height = buf[6] + (buf[7] << 8);
     local = buf[8] & 0x80;
     interleaved = buf[8] & 0x40;
-
+    if (width == 0 || height == 0 || width > 2000000000 / height) {
+        fprintf(stderr, "Invalid value of width or height\n");
+        return(0);
+    }
     if (local == 0 && global == 0) {
         fprintf(stderr, "no colormap present for image\n");
         return (0);
     }
+
     if ((raster = (unsigned char*) _TIFFmalloc(width*height+EXTRAFUDGE)) == NULL) {
         fprintf(stderr, "not enough memory for image\n");
         return (0);
@@ -404,6 +408,10 @@ process(register int code, unsigned char** fill)
             fprintf(stderr, "bad input: code=%d is larger than clear=%d\n",code, clear);
             return 0;
         }
+        if (*fill >= raster + width*height) {
+            fprintf(stderr, "raster full before eoi code\n");
+            return 0;
+        }
 	*(*fill)++ = suffix[code];
 	firstchar = oldcode = code;
 	return 1;
@@ -434,6 +442,10 @@ process(register int code, unsigned char** fill)
     }
     oldcode = incode;
     do {
+        if (*fill >= raster + width*height) {
+            fprintf(stderr, "raster full before eoi code\n");
+            return 0;
+        }
 	*(*fill)++ = *--stackp;
     } while (stackp > stack);
     return 1;
