diff --git a/tools/gif2tiff.c b/tools/gif2tiff.c
index 277ad93d..8405f710 100644
--- a/tools/gif2tiff.c
+++ b/tools/gif2tiff.c
@@ -400,6 +400,10 @@ process(register int code, unsigned char** fill)
     }
 
     if (oldcode == -1) {
+        if (code >= clear) {
+            fprintf(stderr, "bad input: code=%d is larger than clear=%d\n",code, clear);
+            return 0;
+        }
 	*(*fill)++ = suffix[code];
 	firstchar = oldcode = code;
 	return 1;
