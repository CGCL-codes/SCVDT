Index: libtiff/tif_dirread.c
===================================================================
RCS file: /cvs/maptools/cvsroot/libtiff/libtiff/tif_dirread.c,v
retrieving revision 1.92.2.6
diff -u -p -r1.92.2.6 tif_dirread.c
--- libtiff/tif_dirread.c	29 Oct 2009 20:04:32 -0000	1.92.2.6
+++ libtiff/tif_dirread.c	8 Jun 2010 07:12:32 -0000
@@ -1919,6 +1919,13 @@ TIFFFetchSubjectDistance(TIFF* tif, TIFF
 	float v;
 	int ok = 0;
 
+	if( dir->tdir_count != 1 || dir->tdir_type != TIFF_RATIONAL )
+	{
+		TIFFWarningExt(tif->tif_clientdata, tif->tif_name,
+                       "incorrect count or type for SubjectDistance, tag ignored" );
+		return (0);
+	}
+
 	if (TIFFFetchData(tif, dir, (char *)l)
 	    && cvtRational(tif, dir, l[0], l[1], &v)) {
 		/*
