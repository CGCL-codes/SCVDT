Index: utils.c
===================================================================
--- utils.c	(revision 215957)
+++ utils.c	(revision 217888)
@@ -45,6 +45,7 @@
 #include "asterisk/io.h"
 #include "asterisk/logger.h"
 #include "asterisk/md5.h"
+#include "asterisk/sha1.h"
 #include "asterisk/options.h"
 #include "asterisk/compat.h"
 
@@ -297,6 +298,24 @@
 		ptr += sprintf(ptr, "%2.2x", digest[x]);
 }
 
+/*! \brief Produce 40 char SHA1 hash of value. */
+void ast_sha1_hash(char *output, char *input)
+{
+	struct SHA1Context sha;
+	char *ptr;
+	int x;
+	uint8_t Message_Digest[20];
+
+	SHA1Reset(&sha);
+	
+	SHA1Input(&sha, (const unsigned char *) input, strlen(input));
+
+	SHA1Result(&sha, Message_Digest);
+	ptr = output;
+	for (x = 0; x < 20; x++)
+		ptr += sprintf(ptr, "%2.2x", Message_Digest[x]);
+}
+
 int ast_base64decode(unsigned char *dst, const char *src, int max)
 {
 	int cnt = 0;
