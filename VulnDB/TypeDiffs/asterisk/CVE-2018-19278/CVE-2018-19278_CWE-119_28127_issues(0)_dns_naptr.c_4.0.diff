--- a/main/dns_naptr.c
+++ b/main/dns_naptr.c
@@ -475,7 +475,7 @@
 		return NULL;
 	}
 
-	naptr = ast_calloc(1, sizeof(*naptr) + size + flags_size + 1 + services_size + 1 + regexp_size + 1 + replacement_size + 1);
+	naptr = ast_calloc(1, sizeof(*naptr) + size + flags_size + 1 + services_size + 1 + regexp_size + 1 + strlen(replacement) + 1);
 	if (!naptr) {
 		return NULL;
 	}
