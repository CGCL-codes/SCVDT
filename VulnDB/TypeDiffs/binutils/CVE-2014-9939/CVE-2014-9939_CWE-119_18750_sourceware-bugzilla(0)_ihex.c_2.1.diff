diff --git a/bfd/ihex.c b/bfd/ihex.c
index 8e66372..3e4128c 100644
--- a/bfd/ihex.c
+++ b/bfd/ihex.c
@@ -216,10 +216,17 @@ ihex_bad_byte (bfd *abfd, unsigned int lineno, int c, bfd_boolean error)
     }
   else
     {
-      char buf[10];
+      char buf[1 + 11 + 1]; /* '\\' + "37777777777" + '\0' */
 
       if (! ISPRINT (c))
-	sprintf (buf, "\\%03o", (unsigned int) c);
+      {
+	int len = snprintf (buf, sizeof(buf), "\\%03o", (unsigned int) c);
+
+	if (len < 0 || (unsigned int) len >= sizeof(buf)) {
+		buf[0] = '?';
+		buf[1] = '\0';
+	}
+      }
       else
 	{
 	  buf[0] = c;
-- 
2.1.4

