diff --git a/libiberty/cplus-dem.c b/libiberty/cplus-dem.c
index 6d58bd899b..335ee23a67 100644
--- a/libiberty/cplus-dem.c
+++ b/libiberty/cplus-dem.c
@@ -47,6 +47,7 @@ Boston, MA 02110-1301, USA.  */
 #include <sys/types.h>
 #include <string.h>
 #include <stdio.h>
+#include<stdint.h>
 
 #ifdef HAVE_STDLIB_H
 #include <stdlib.h>
@@ -2225,6 +2226,10 @@ demangle_template (struct work_stuff *work, const char **mangled,
   if (!is_type)
     {
       /* Create an array for saving the template argument values. */
+      if ((unsigned int)r > SIZE_MAX / sizeof(char*))
+        {
+          return (0);
+        }
       work->tmpl_argvec = XNEWVEC (char *, r);
       work->ntmpl_args = r;
       for (i = 0; i < r; i++)
-- 
2.12.3

