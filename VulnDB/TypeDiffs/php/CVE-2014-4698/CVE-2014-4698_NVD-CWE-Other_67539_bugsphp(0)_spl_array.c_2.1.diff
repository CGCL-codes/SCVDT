diff --git a/ext/spl/spl_array.c b/ext/spl/spl_array.c
index c38065f..a75f9ca 100644
--- a/ext/spl/spl_array.c
+++ b/ext/spl/spl_array.c
@@ -1737,6 +1737,12 @@ SPL_METHOD(Array, unserialize)
 {
 	spl_array_object *intern = (spl_array_object*)zend_object_store_get_object(getThis() TSRMLS_CC);

+	HashTable *htable = spl_array_get_hash_table(intern, 0 TSRMLS_CC);
+	if (htable->nApplyCount > 0) {
+		zend_error(E_WARNING, "Modification of ArrayObject during sorting is prohibited");
+		return;
+	}
+
 	char *buf;
 	int buf_len;
 	const unsigned char *p, *s;