diff --git a/php-5.4.43/spl_observer.c b/php-5.4.43-fixed/spl_observer.c
index da9110b..195bc72 100644
--- a/php-5.4.43/spl_observer.c
+++ b/php-5.4.43-fixed/spl_observer.c
@@ -831,6 +831,8 @@ SPL_METHOD(SplObjectStorage, unserialize)
 	if (!php_var_unserialize(&pcount, &p, s + buf_len, &var_hash TSRMLS_CC) || Z_TYPE_P(pcount) != IS_LONG) {
 		goto outexcept;
 	}
+	
+	var_push_dtor(&var_hash, &pcount);
 
 	--p; /* for ';' */
 	count = Z_LVAL_P(pcount);
@@ -902,6 +904,8 @@ SPL_METHOD(SplObjectStorage, unserialize)
 		zval_ptr_dtor(&pmembers);
 		goto outexcept;
 	}
+	
+	var_push_dtor(&var_hash, &pmembers);
 
 	/* copy members */
 	if (!intern->std.properties) {