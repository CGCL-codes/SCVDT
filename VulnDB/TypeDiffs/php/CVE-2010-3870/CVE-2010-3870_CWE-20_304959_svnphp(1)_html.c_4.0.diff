--- php/php-src/trunk/ext/standard/html.c	2010/10/27 14:56:51	304958
+++ php/php-src/trunk/ext/standard/html.c	2010/10/27 18:13:25	304959
@@ -92,9 +92,9 @@
 
 /* {{{ get_next_char
  */
-static unsigned int get_next_char(
+static inline unsigned int get_next_char(
 		enum entity_charset charset,
-		unsigned char *str,
+		const unsigned char *str,
 		size_t str_len,
 		size_t *cursor,
 		int *status)
@@ -352,6 +352,18 @@
 }
 /* }}} */
 
+/* {{{ php_next_utf8_char
+ * Public interface for get_next_char used with UTF-8 */
+ PHPAPI unsigned int php_next_utf8_char(
+		const unsigned char *str,
+		size_t str_len,
+		size_t *cursor,
+		int *status)
+{
+	return get_next_char(cs_utf_8, str, str_len, cursor, status);
+}
+/* }}} */
+
 /* {{{ entity_charset determine_charset
  * returns the charset identifier based on current locale or a hint.
  * defaults to UTF-8 */
