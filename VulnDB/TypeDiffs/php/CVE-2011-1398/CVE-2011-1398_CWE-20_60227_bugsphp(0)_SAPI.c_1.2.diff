Index: main/SAPI.c
===================================================================
--- main/SAPI.c	( 318792)
+++ main/SAPI.c	()
@@ -712,7 +712,7 @@
 	} else {
 		/* new line safety check */
 		char *s = header_line, *e = header_line + header_line_len, *p;
-		while (s < e && (p = memchr(s, '\n', (e - s)))) {
+		while (s < e && ((p = memchr(s, '\n', (e - s))) || (p = memchr(s, '\r', (e - s))))) {
 			if (*(p + 1) == ' ' || *(p + 1) == '\t') {
 				s = p + 1;
 				continue;
