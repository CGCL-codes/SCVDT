--- php/php-src/branches/PHP_5_2/ext/posix/posix.c	2009/09/29 14:01:33	288942
+++ php/php-src/branches/PHP_5_2/ext/posix/posix.c	2009/09/29 14:02:50	288943
@@ -679,7 +679,8 @@
 		RETURN_FALSE;
 	}
 
-	if (PG(safe_mode) && (!php_checkuid(path, NULL, CHECKUID_ALLOW_ONLY_DIR))) {
+	if (php_check_open_basedir_ex(path, 0 TSRMLS_CC) ||
+			(PG(safe_mode) && (!php_checkuid(path, NULL, CHECKUID_ALLOW_ONLY_DIR)))) {
 		RETURN_FALSE;
 	}
 
