diff --git a/ext/standard/string.c b/ext/standard/string.c
index 53791b0868..e7623bc7fb 100644
--- a/ext/standard/string.c
+++ b/ext/standard/string.c
@@ -3083,7 +3083,7 @@ static char* php_chunk_split(char *src, int srclen, char *end, int endlen, int c
 	int chunks; /* complete chunks! */
 	int restlen;
 	int charsize = sizeof(char);
-	int out_len;
+	float out_len;
 
 	if (str_type == IS_UNICODE) {
 		charsize = sizeof(UChar);
@@ -3092,13 +3092,15 @@ static char* php_chunk_split(char *src, int srclen, char *end, int endlen, int c
 	chunks = srclen / chunklen;
 	restlen = srclen - chunks * chunklen; /* srclen % chunklen */
 
-	out_len = (srclen + (chunks + 1) * endlen + 1);
+	out_len = chunks + 1;
+	out_len *= endlen;
+	out_len += srclen + 1;
 
 	if ((out_len > INT_MAX || out_len <= 0) || ((out_len * charsize) > INT_MAX || (out_len * charsize) <= 0)) {
 		return NULL;
 	}
 
-	dest = safe_emalloc(out_len, charsize, 0);
+	dest = safe_emalloc((int)out_len, charsize, 0);
 
 	for (p = src, q = dest; p < (src + charsize * (srclen - chunklen + 1)); ) {
 		memcpy(q, p, chunklen * charsize);
