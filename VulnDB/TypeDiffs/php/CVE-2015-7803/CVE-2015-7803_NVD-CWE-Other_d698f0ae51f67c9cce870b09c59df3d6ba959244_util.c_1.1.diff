diff --git a/ext/phar/util.c b/ext/phar/util.c
index 2c41adf92a7e..69da7b9b89db 100644
--- a/ext/phar/util.c
+++ b/ext/phar/util.c
@@ -494,7 +494,11 @@ int phar_get_entry_data(phar_entry_data **ret, char *fname, int fname_len, char
 	(*ret)->is_tar = entry->is_tar;
 	(*ret)->fp = phar_get_efp(entry, 1 TSRMLS_CC);
 	if (entry->link) {
-		(*ret)->zero = phar_get_fp_offset(phar_get_link_source(entry TSRMLS_CC) TSRMLS_CC);
+		phar_entry_info *link = phar_get_link_source(entry TSRMLS_CC);
+		if(!link) {
+			return FAILURE;
+		}
+		(*ret)->zero = phar_get_fp_offset(link TSRMLS_CC);
 	} else {
 		(*ret)->zero = phar_get_fp_offset(entry TSRMLS_CC);
 	}
