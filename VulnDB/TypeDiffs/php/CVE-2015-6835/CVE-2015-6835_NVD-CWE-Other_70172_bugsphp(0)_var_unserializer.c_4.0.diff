diff --git a/php-5.4.43/var_unserializer.c b/php-5.4.43-fixed/var_unserializer.c
index 8c4e629..99b61cb 100644
--- a/php-5.4.43/var_unserializer.c
+++ b/php-5.4.43-fixed/var_unserializer.c
@@ -363,8 +363,10 @@ static inline int process_nested_data(UNSERIALIZE_PARAMETER, HashTable *ht, long
 
 static inline int finish_nested_data(UNSERIALIZE_PARAMETER)
 {
-	if (*((*p)++) == '}')
+	if (*((*p)++) == '}') {
+		var_push_dtor(var_hash, rval);
 		return 1;
+	}
 
 #if SOMETHING_NEW_MIGHT_LEAD_TO_CRASH_ENABLE_IF_YOU_ARE_BRAVE
 	zval_ptr_dtor(rval);
@@ -880,6 +882,7 @@ yy41:
 
 	INIT_PZVAL(*rval);
 	ZVAL_STRINGL(*rval, str, len, 0);
+	var_push_dtor(var_hash, rval);
 	return 1;
 }
 yy46:
@@ -927,6 +930,7 @@ yy48:
 
 	INIT_PZVAL(*rval);
 	ZVAL_STRINGL(*rval, str, len, 1);
+	var_push_dtor(var_hash, rval);
 	return 1;
 }
 yy53:
@@ -1023,6 +1027,7 @@ use_double:
 	*p = YYCURSOR;
 	INIT_PZVAL(*rval);
 	ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));
+	var_push_dtor(var_hash, rval);
 	return 1;
 }
 yy65:
@@ -1094,6 +1099,8 @@ yy73:
 	} else if (!strncmp(start + 2, "-INF", 4)) {
 		ZVAL_DOUBLE(*rval, -php_get_inf());
 	}
+	
+	var_push_dtor(var_hash, rval);
 
 	return 1;
 }
@@ -1147,6 +1154,7 @@ yy79:
 	*p = YYCURSOR;
 	INIT_PZVAL(*rval);
 	ZVAL_LONG(*rval, parse_iv(start + 2));
+	var_push_dtor(var_hash, rval);
 	return 1;
 }
 yy83:
@@ -1160,6 +1168,7 @@ yy83:
 	*p = YYCURSOR;
 	INIT_PZVAL(*rval);
 	ZVAL_BOOL(*rval, parse_iv(start + 2));
+	var_push_dtor(var_hash, rval);
 	return 1;
 }
 yy87:
@@ -1168,6 +1177,7 @@ yy87:
 	*p = YYCURSOR;
 	INIT_PZVAL(*rval);
 	ZVAL_NULL(*rval);
+	var_push_dtor(var_hash, rval);
 	return 1;
 }
 yy89: