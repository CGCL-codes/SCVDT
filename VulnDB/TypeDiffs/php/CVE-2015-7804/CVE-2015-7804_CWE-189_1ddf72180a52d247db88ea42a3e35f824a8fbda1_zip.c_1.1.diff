diff --git a/ext/phar/zip.c b/ext/phar/zip.c
index 142165c31da4..e4883d3533dd 100644
--- a/ext/phar/zip.c
+++ b/ext/phar/zip.c
@@ -396,7 +396,9 @@ int phar_parse_zipfile(php_stream *fp, char *fname, int fname_len, char *alias,
 
 		if (entry.filename[entry.filename_len - 1] == '/') {
 			entry.is_dir = 1;
-			entry.filename_len--;
+			if(entry.filename_len > 1) {
+				entry.filename_len--;
+			}
 			entry.flags |= PHAR_ENT_PERM_DEF_DIR;
 		} else {
 			entry.is_dir = 0;
