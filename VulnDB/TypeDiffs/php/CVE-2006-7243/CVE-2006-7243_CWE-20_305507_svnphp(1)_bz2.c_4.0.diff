--- php/php-src/branches/PHP_5_3/ext/bz2/bz2.c	2010/11/18 14:59:28	305506
+++ php/php-src/branches/PHP_5_3/ext/bz2/bz2.c	2010/11/18 15:22:22	305507
@@ -387,6 +387,9 @@
 	if (Z_TYPE_PP(file) == IS_STRING) {
 		convert_to_string_ex(file);
 
+		if (strlen(Z_STRVAL_PP(file)) != Z_STRLEN_PP(file)) {
+			RETURN_FALSE;
+		}
 		if (Z_STRLEN_PP(file) == 0) {
 			php_error_docref(NULL TSRMLS_CC, E_WARNING, "filename cannot be empty");
 			RETURN_FALSE;
