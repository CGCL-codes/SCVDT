--- php/php-src/branches/PHP_5_3/main/fopen_wrappers.c	2010/11/18 14:59:28	305506
+++ php/php-src/branches/PHP_5_3/main/fopen_wrappers.c	2010/11/18 15:22:22	305507
@@ -538,6 +538,10 @@
 		return NULL;
 	}
 
+	if (strlen(filename) != filename_length) {
+		return NULL;
+	}
+
 	/* Don't resolve paths which contain protocol (except of file://) */
 	for (p = filename; isalnum((int)*p) || *p == '+' || *p == '-' || *p == '.'; p++);
 	if ((*p == ':') && (p - filename > 1) && (p[1] == '/') && (p[2] == '/')) {
