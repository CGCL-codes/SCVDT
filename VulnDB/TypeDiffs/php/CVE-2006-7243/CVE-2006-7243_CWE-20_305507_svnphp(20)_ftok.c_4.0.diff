--- php/php-src/branches/PHP_5_3/ext/standard/ftok.c	2010/11/18 14:59:28	305506
+++ php/php-src/branches/PHP_5_3/ext/standard/ftok.c	2010/11/18 15:22:22	305507
@@ -39,6 +39,10 @@
 		return;
 	}
 
+	if (strlen(pathname) != pathname_len) {
+		RETURN_FALSE;
+	}
+
 	if (pathname_len == 0){
 		php_error_docref(NULL TSRMLS_CC, E_WARNING, "Pathname is invalid");
 		RETURN_LONG(-1);
