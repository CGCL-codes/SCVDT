--- php/php-src/branches/PHP_5_3/ext/com_dotnet/com_persist.c	2010/11/18 14:59:28	305506
+++ php/php-src/branches/PHP_5_3/ext/com_dotnet/com_persist.c	2010/11/18 15:22:22	305507
@@ -389,6 +389,9 @@
 		}
 
 		if (filename) {
+			if (strlen(filename) != filename_len) {
+				RETURN_FALSE;
+			}
 			fullpath = expand_filepath(filename, NULL TSRMLS_CC);
 			if (!fullpath) {
 				RETURN_FALSE;
@@ -453,6 +456,10 @@
 			return;
 		}
 
+		if (strlen(filename) != filename_len) {
+			RETURN_FALSE;
+		}
+
 		if (!(fullpath = expand_filepath(filename, NULL TSRMLS_CC))) {
 			RETURN_FALSE;
 		}
