--- php/php-src/branches/PHP_5_3/ext/gd/gd_ctx.c	2010/11/18 14:59:28	305506
+++ php/php-src/branches/PHP_5_3/ext/gd/gd_ctx.c	2010/11/18 15:22:22	305507
@@ -91,6 +91,9 @@
 	}
 
 	if (argc > 1 && file_len) {
+		if (strlen(file) != file_len) {
+			RETURN_FALSE;
+		}
 		PHP_GD_CHECK_OPEN_BASEDIR(file, "Invalid filename");
 
 		fp = VCWD_FOPEN(file, "wb");
