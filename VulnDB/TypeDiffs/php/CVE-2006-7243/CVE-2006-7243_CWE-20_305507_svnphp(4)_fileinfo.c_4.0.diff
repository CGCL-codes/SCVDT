--- php/php-src/branches/PHP_5_3/ext/fileinfo/fileinfo.c	2010/11/18 14:59:28	305506
+++ php/php-src/branches/PHP_5_3/ext/fileinfo/fileinfo.c	2010/11/18 15:22:22	305507
@@ -294,6 +294,9 @@
 	if (file_len == 0) {
 		file = NULL;
 	} else if (file && *file) { /* user specified file, perform open_basedir checks */
+		if (strlen(file) != file_len) {
+			RETURN_FALSE;
+		}
 		if (!VCWD_REALPATH(file, resolved_path)) {
 			RETURN_FALSE;
 		}
