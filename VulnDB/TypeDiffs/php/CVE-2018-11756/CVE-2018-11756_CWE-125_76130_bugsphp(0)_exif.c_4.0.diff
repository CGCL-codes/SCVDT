diff --git a/ext/exif/exif.c b/ext/exif/exif.c
index d1155de93f..da943f52a7 100644
--- a/ext/exif/exif.c
+++ b/ext/exif/exif.c
@@ -2090,7 +2090,7 @@ static void exif_iif_add_value(image_info_type *image_info, int section_index, c
 		case TAG_FMT_UNDEFINED:
 			if (value) {
 				if (tag == TAG_MAKER_NOTE) {
-					length = MIN(length, strlen(value));
+					length = (int) php_strnlen(value, length);
 				}
 
 				/* do not recompute length here */
