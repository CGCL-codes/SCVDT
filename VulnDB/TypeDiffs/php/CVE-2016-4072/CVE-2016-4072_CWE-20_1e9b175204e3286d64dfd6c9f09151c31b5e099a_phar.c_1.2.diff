diff --git a/ext/phar/phar.c b/ext/phar/phar.c
index 18feace9f93c..08f480d3034d 100644
--- a/ext/phar/phar.c
+++ b/ext/phar/phar.c
@@ -2196,6 +2196,10 @@ int phar_split_fname(const char *filename, int filename_len, char **arch, int *a
 #endif
 	int ext_len;
 
+	if (CHECK_NULL_PATH(filename, filename_len)) {
+		return FAILURE;
+	}
+
 	if (!strncasecmp(filename, "phar://", 7)) {
 		filename += 7;
 		filename_len -= 7;
