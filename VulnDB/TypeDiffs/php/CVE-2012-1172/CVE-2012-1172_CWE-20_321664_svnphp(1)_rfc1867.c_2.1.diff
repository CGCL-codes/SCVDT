--- php/php-src/branches/PHP_5_4/main/rfc1867.c	2012/01/01 23:51:21	321663
+++ php/php-src/branches/PHP_5_4/main/rfc1867.c	2012/01/01 23:54:25	321664
@@ -556,7 +556,7 @@
 {
 	char *s = strrchr(path, '\\');
 	char *s2 = strrchr(path, '/');
-	
+
 	if (s && s2) {
 		if (s > s2) {
 			++s;
@@ -942,6 +942,10 @@
 					}
 					tmp++;
 				}
+				/* Brackets should always be closed */
+				if(c != 0) {
+					skip_upload = 1;
+				}
 			}
 
 			total_bytes = cancel_upload = 0;
@@ -977,7 +981,7 @@
 
 			offset = 0;
 			end = 0;
-			
+
 			if (!cancel_upload) {
 				/* only bother to open temp file if we have data */
 				blen = multipart_buffer_read(mbuff, buff, sizeof(buff), &end TSRMLS_CC);
@@ -1275,7 +1279,7 @@
 	php_rfc1867_getword = getword;
 	php_rfc1867_getword_conf = getword_conf;
 	php_rfc1867_basename = basename;
-}	
+}
 /* }}} */
 
 /*
